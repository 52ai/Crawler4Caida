"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const worker_utils_1 = require("@loaders.gl/worker-utils");
const draco_writer_nodejs_1 = require("../draco-writer-nodejs");
(() => {
    // Check that we are actually in a worker thread
    if (!worker_utils_1.WorkerBody.inWorkerThread()) {
        return;
    }
    worker_utils_1.WorkerBody.onmessage = async (type, payload) => {
        switch (type) {
            case 'process':
                try {
                    const { input, options } = payload;
                    const result = await draco_writer_nodejs_1.DracoWriterNodeJS.encode(input, options);
                    worker_utils_1.WorkerBody.postMessage('done', { result });
                }
                catch (error) {
                    const message = error instanceof Error ? error.message : '';
                    worker_utils_1.WorkerBody.postMessage('error', { error: message });
                }
                break;
            default:
        }
    };
})();
