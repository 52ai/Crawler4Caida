{"version":3,"sources":["../../../../../src/lib/parsers/helpers/normalize-3d-tile-normals.ts"],"names":["scratchNormal","Vector3","normalize3DTileNormalAttribute","tile","normals","isOctEncoded16P","decodedArray","Float32Array","pointsLength","i","toArray","type","GL","FLOAT","size","value"],"mappings":";;;;;;;AAAA;;AACA;;AAEA,IAAMA,aAAa,GAAG,IAAIC,aAAJ,EAAtB;;AAEO,SAASC,8BAAT,CAAwCC,IAAxC,EAA8CC,OAA9C,EAAuD;AAC5D,MAAI,CAACA,OAAL,EAAc;AACZ,WAAO,IAAP;AACD;;AAED,MAAID,IAAI,CAACE,eAAT,EAA0B;AACxB,QAAMC,YAAY,GAAG,IAAIC,YAAJ,CAAiBJ,IAAI,CAACK,YAAL,GAAoB,CAArC,CAArB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,IAAI,CAACK,YAAzB,EAAuCC,CAAC,EAAxC,EAA4C;AAC1C,2BAAUL,OAAO,CAACK,CAAC,GAAG,CAAL,CAAjB,EAA0BL,OAAO,CAACK,CAAC,GAAG,CAAJ,GAAQ,CAAT,CAAjC,EAA8CT,aAA9C;AAEAA,MAAAA,aAAa,CAACU,OAAd,CAAsBJ,YAAtB,EAAoCG,CAAC,GAAG,CAAxC;AACD;;AAED,WAAO;AACLE,MAAAA,IAAI,EAAEC,SAAGC,KADJ;AAELC,MAAAA,IAAI,EAAE,CAFD;AAGLC,MAAAA,KAAK,EAAET;AAHF,KAAP;AAKD;;AAED,SAAO;AACLK,IAAAA,IAAI,EAAEC,SAAGC,KADJ;AAELC,IAAAA,IAAI,EAAE,CAFD;AAGLC,IAAAA,KAAK,EAAEX;AAHF,GAAP;AAKD","sourcesContent":["import {Vector3} from '@math.gl/core';\nimport {GL, octDecode} from '@loaders.gl/math';\n\nconst scratchNormal = new Vector3();\n\nexport function normalize3DTileNormalAttribute(tile, normals) {\n  if (!normals) {\n    return null;\n  }\n\n  if (tile.isOctEncoded16P) {\n    const decodedArray = new Float32Array(tile.pointsLength * 3);\n    for (let i = 0; i < tile.pointsLength; i++) {\n      octDecode(normals[i * 2], normals[i * 2 + 1], scratchNormal);\n      // @ts-ignore\n      scratchNormal.toArray(decodedArray, i * 3);\n    }\n\n    return {\n      type: GL.FLOAT,\n      size: 2,\n      value: decodedArray\n    };\n  }\n\n  return {\n    type: GL.FLOAT,\n    size: 2,\n    value: normals\n  };\n}\n"],"file":"normalize-3d-tile-normals.js"}