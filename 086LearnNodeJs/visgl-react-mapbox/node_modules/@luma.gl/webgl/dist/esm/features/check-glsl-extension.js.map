{"version":3,"file":"check-glsl-extension.js","names":["isOldIE","WEBGL_FEATURES","assert","compiledGlslExtensions","canCompileGLGSExtension","gl","cap","options","feature","extensionName","source","shader","createShader","shaderSource","compileShader","canCompile","getShaderParameter","deleteShader"],"sources":["../../../src/features/check-glsl-extension.js"],"sourcesContent":["import isOldIE from './check-old-ie';\nimport WEBGL_FEATURES from './webgl-features-table';\nimport {assert} from '../utils/assert';\n\n// Enables feature detection in IE11 due to a bug where gl.getExtension may return true\n// but fail to compile when the extension is enabled in the shader. Specifically,\n// the OES_standard_derivatives extension fails to compile in IE11 even though its included\n// in the list of supported extensions.\nconst compiledGlslExtensions = {};\n\n// options allows user agent to be overridden for testing\nexport default function canCompileGLGSExtension(gl, cap, options = {}) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n\n  if (!isOldIE(options)) {\n    return true;\n  }\n\n  if (cap in compiledGlslExtensions) {\n    return compiledGlslExtensions[cap];\n  }\n\n  const extensionName = feature[0];\n  const source = `#extension GL_${extensionName} : enable\\nvoid main(void) {}`;\n\n  const shader = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const canCompile = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  gl.deleteShader(shader);\n  compiledGlslExtensions[cap] = canCompile;\n  return canCompile;\n}\n"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,gBAApB;AACA,OAAOC,cAAP,MAA2B,wBAA3B;AACA,SAAQC,MAAR,QAAqB,iBAArB;AAMA,MAAMC,sBAAsB,GAAG,EAA/B;AAGA,eAAe,SAASC,uBAAT,CAAiCC,EAAjC,EAAqCC,GAArC,EAAwD;EAAA,IAAdC,OAAc,uEAAJ,EAAI;EACrE,MAAMC,OAAO,GAAGP,cAAc,CAACK,GAAD,CAA9B;EACAJ,MAAM,CAACM,OAAD,EAAUF,GAAV,CAAN;;EAEA,IAAI,CAACN,OAAO,CAACO,OAAD,CAAZ,EAAuB;IACrB,OAAO,IAAP;EACD;;EAED,IAAID,GAAG,IAAIH,sBAAX,EAAmC;IACjC,OAAOA,sBAAsB,CAACG,GAAD,CAA7B;EACD;;EAED,MAAMG,aAAa,GAAGD,OAAO,CAAC,CAAD,CAA7B;EACA,MAAME,MAAM,2BAAoBD,aAApB,kCAAZ;EAEA,MAAME,MAAM,GAAGN,EAAE,CAACO,YAAH,OAAf;EACAP,EAAE,CAACQ,YAAH,CAAgBF,MAAhB,EAAwBD,MAAxB;EACAL,EAAE,CAACS,aAAH,CAAiBH,MAAjB;EACA,MAAMI,UAAU,GAAGV,EAAE,CAACW,kBAAH,CAAsBL,MAAtB,QAAnB;EACAN,EAAE,CAACY,YAAH,CAAgBN,MAAhB;EACAR,sBAAsB,CAACG,GAAD,CAAtB,GAA8BS,UAA9B;EACA,OAAOA,UAAP;AACD"}