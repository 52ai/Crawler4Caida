{"version":3,"sources":["../../../../src/layers/schema/carto-vector-tile-loader.ts"],"names":["CartoVectorTileLoader","name","version","id","module","extensions","mimeTypes","category","worker","parse","arrayBuffer","options","parseCartoVectorTile","parseSync","tile","TileReader","points","lines","polygons","data","properties"],"mappings":";;;;;;;;;;;;;;;AAGA;;AACA;;;;;;AAEA,IAAMA,qBAAuC,GAAG;AAC9CC,EAAAA,IAAI,EAAE,mBADwC;AAE9CC,EAAAA,OAAO,EAAE,GAFqC;AAG9CC,EAAAA,EAAE,EAAE,iBAH0C;AAI9CC,EAAAA,MAAM,EAAE,OAJsC;AAK9CC,EAAAA,UAAU,EAAE,CAAC,KAAD,CALkC;AAM9CC,EAAAA,SAAS,EAAE,CAAC,mCAAD,CANmC;AAO9CC,EAAAA,QAAQ,EAAE,UAPoC;AAQ9CC,EAAAA,MAAM,EAAE,KARsC;AAS9CC,EAAAA,KAAK;AAAA,2EAAE,iBAAOC,WAAP,EAAoBC,OAApB;AAAA;AAAA;AAAA;AAAA;AAAA,+CAAgCC,oBAAoB,CAACF,WAAD,EAAcC,OAAd,CAApD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KATyC;AAU9CE,EAAAA,SAAS,EAAED,oBAVmC;AAW9CD,EAAAA,OAAO,EAAE;AAXqC,CAAhD;;AAcA,SAASC,oBAAT,CACEF,WADF,EAEEC,OAFF,EAGyB;AACvB,MAAI,CAACD,WAAL,EAAkB,OAAO,IAAP;AAClB,MAAMI,IAAI,GAAG,+BAASJ,WAAT,EAAsBK,qBAAtB,CAAb;AAEA,MAAOC,MAAP,GAAkCF,IAAlC,CAAOE,MAAP;AAAA,MAAeC,KAAf,GAAkCH,IAAlC,CAAeG,KAAf;AAAA,MAAsBC,QAAtB,GAAkCJ,IAAlC,CAAsBI,QAAtB;AACA,MAAMC,IAAI,GAAG;AACXH,IAAAA,MAAM,kCAAMA,MAAN;AAAcI,MAAAA,UAAU,EAAE,uCAAiBJ,MAAM,CAACI,UAAxB;AAA1B,MADK;AAEXH,IAAAA,KAAK,kCAAMA,KAAN;AAAaG,MAAAA,UAAU,EAAE,uCAAiBH,KAAK,CAACG,UAAvB;AAAzB,MAFM;AAGXF,IAAAA,QAAQ,kCAAMA,QAAN;AAAgBE,MAAAA,UAAU,EAAE,uCAAiBF,QAAQ,CAACE,UAA1B;AAA5B;AAHG,GAAb;AAOA,SAAOD,IAAP;AACD;;eAEcnB,qB","sourcesContent":["import {LoaderOptions, LoaderWithParser} from '@loaders.gl/loader-utils';\nimport type {BinaryFeatures} from '@loaders.gl/schema';\n\nimport {TileReader} from './carto-tile';\nimport {parsePbf, unpackProperties} from './tile-loader-utils';\n\nconst CartoVectorTileLoader: LoaderWithParser = {\n  name: 'CARTO Vector Tile',\n  version: '1',\n  id: 'cartoVectorTile',\n  module: 'carto',\n  extensions: ['pbf'],\n  mimeTypes: ['application/vnd.carto-vector-tile'],\n  category: 'geometry',\n  worker: false,\n  parse: async (arrayBuffer, options) => parseCartoVectorTile(arrayBuffer, options),\n  parseSync: parseCartoVectorTile,\n  options: {}\n};\n\nfunction parseCartoVectorTile(\n  arrayBuffer: ArrayBuffer,\n  options?: LoaderOptions\n): BinaryFeatures | null {\n  if (!arrayBuffer) return null;\n  const tile = parsePbf(arrayBuffer, TileReader);\n\n  const {points, lines, polygons} = tile;\n  const data = {\n    points: {...points, properties: unpackProperties(points.properties)},\n    lines: {...lines, properties: unpackProperties(lines.properties)},\n    polygons: {...polygons, properties: unpackProperties(polygons.properties)}\n  };\n\n  // Note: there is slight, difference in `numericProps` type, however geojson/mvtlayer can cope with this\n  return data as unknown as BinaryFeatures;\n}\n\nexport default CartoVectorTileLoader;\n"],"file":"carto-vector-tile-loader.js"}