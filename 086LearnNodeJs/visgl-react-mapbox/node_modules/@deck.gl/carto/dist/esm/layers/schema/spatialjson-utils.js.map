{"version":3,"sources":["../../../../src/layers/schema/spatialjson-utils.ts"],"names":["bigIntToIndex","binaryToSpatialjson","binary","cells","count","indices","value","length","spatial","i","id","properties","key","Object","keys","numericProps","push"],"mappings":"AAAA,SAAQA,aAAR,QAA4B,kBAA5B;AAmBA,OAAO,SAASC,mBAAT,CAA6BC,MAA7B,EAAiE;AACtE,QAAM;AAACC,IAAAA;AAAD,MAAUD,MAAhB;AACA,QAAME,KAAK,GAAGD,KAAK,CAACE,OAAN,CAAcC,KAAd,CAAoBC,MAAlC;AACA,QAAMC,OAAc,GAAG,EAAvB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,KAApB,EAA2BK,CAAC,EAA5B,EAAgC;AAC9B,UAAMC,EAAE,GAAGV,aAAa,CAACG,KAAK,CAACE,OAAN,CAAcC,KAAd,CAAoBG,CAApB,CAAD,CAAxB;AAEA,UAAME,UAAU,GAAG,EAAC,GAAGR,KAAK,CAACQ,UAAN,CAAiBF,CAAjB;AAAJ,KAAnB;;AACA,SAAK,MAAMG,GAAX,IAAkBC,MAAM,CAACC,IAAP,CAAYX,KAAK,CAACY,YAAlB,CAAlB,EAAmD;AACjDJ,MAAAA,UAAU,CAACC,GAAD,CAAV,GAAkBT,KAAK,CAACY,YAAN,CAAmBH,GAAnB,EAAwBN,KAAxB,CAA8BG,CAA9B,CAAlB;AACD;;AACDD,IAAAA,OAAO,CAACQ,IAAR,CAAa;AAACN,MAAAA,EAAD;AAAKC,MAAAA;AAAL,KAAb;AACD;;AAED,SAAOH,OAAP;AACD","sourcesContent":["import {bigIntToIndex} from '../quadbin-utils';\n\nexport type IndexScheme = 'h3' | 'quadbin';\ntype TypedArray = Float32Array | Float64Array;\n\nexport type Indices = {value: BigUint64Array};\nexport type NumericProps = Record<string, {value: number[] | TypedArray}>;\nexport type Properties = Record<string, string | number | boolean | null>;\nexport type Cells = {\n  indices: Indices;\n  numericProps: NumericProps;\n  properties: Properties[];\n};\nexport type SpatialBinary = {scheme?: IndexScheme; cells: Cells};\nexport type SpatialJson = {\n  id: string;\n  properties: Properties;\n}[];\n\nexport function binaryToSpatialjson(binary: SpatialBinary): SpatialJson {\n  const {cells} = binary;\n  const count = cells.indices.value.length;\n  const spatial: any[] = [];\n  for (let i = 0; i < count; i++) {\n    const id = bigIntToIndex(cells.indices.value[i]);\n\n    const properties = {...cells.properties[i]};\n    for (const key of Object.keys(cells.numericProps)) {\n      properties[key] = cells.numericProps[key].value[i];\n    }\n    spatial.push({id, properties});\n  }\n\n  return spatial;\n}\n"],"file":"spatialjson-utils.js"}