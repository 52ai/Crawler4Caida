!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("deck"),require("luma")):"function"==typeof define&&define.amd?define(["deck","luma"],t):"object"==typeof exports?exports.deck=t(require("deck"),require("luma")):e.deck=t(e.deck,e.luma)}(window,(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=42)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(t,n){t.exports=e},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){e.exports=n(60)},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},function(e,t,n){var r=n(49);function o(t,n,i){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=o=Reflect.get:e.exports=o=function(e,t,n){var o=r(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}},o(t,n,i||t)}e.exports=o},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,n){e.exports=t},function(e,t){function n(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}},function(e,t,n){var r=n(50);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(8),o=n(13);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r=n(57),o=n(58),i=n(33),a=n(59);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(61),o=n(62),i=n(63);e.exports=function(e){return r(e)||o(e)||i()}},function(e,t,n){var r=n(51),o=n(52),i=n(53);e.exports=function(e,t){return r(e)||o(e,t)||i()}},function(e,t,n){var r=n(35);e.exports=function(e){return new r(e)}},function(e,t,n){var r=n(66);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}}},function(e,t){e.exports=function(e){var t;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}},function(e,t,n){var r=n(54),o=n(55),i=n(33),a=n(56);e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},,function(e,t){},,,function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){},,,,,,function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(32);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){},function(e,t){e.exports=function(e){this.wrapped=e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r,s,c,u,l,d,g,v=t&&t.length,y=v?t[0]*n:e.length,m=o(e,0,y,n,!0),b=[];if(!m||m.next===m.prev)return b;if(v&&(m=function(e,t,n,r){var a,s,c,u,l,d=[];for(a=0,s=t.length;a<s;a++)c=t[a]*r,u=a<s-1?t[a+1]*r:e.length,(l=o(e,c,u,r,!1))===l.next&&(l.steiner=!0),d.push(h(l));for(d.sort(f),a=0;a<d.length;a++)p(d[a],n),n=i(n,n.next);return n}(e,t,m,n)),e.length>80*n){r=c=e[0],s=u=e[1];for(var x=n;x<y;x+=n)(l=e[x])<r&&(r=l),(d=e[x+1])<s&&(s=d),l>c&&(c=l),d>u&&(u=d);g=0!==(g=Math.max(c-r,u-s))?1/g:0}return a(m,b,n,r,s,g),b}function o(e,t,n,r,o){var i,a;if(o===L(e,t,n,r)>0)for(i=t;i<n;i+=r)a=S(i,e[i],e[i+1],a);else for(i=n-r;i>=t;i-=r)a=S(i,e[i],e[i+1],a);return a&&b(a,a.next)&&(C(a),a=a.next),a}function i(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(C(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,o,f,p){if(e){!p&&f&&function(e,t,n,r){var o=e;do{null===o.z&&(o.z=g(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,a,s,c,u=1;do{for(n=e,e=null,i=null,a=0;n;){for(a++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(o=n,n=n.nextZ,s--):(o=r,r=r.nextZ,c--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,u*=2}while(a>1)}(o)}(e,r,o,f);for(var d,h,v=e;e.prev!==e.next;)if(d=e.prev,h=e.next,f?c(e,r,o,f):s(e))t.push(d.i/n),t.push(e.i/n),t.push(h.i/n),C(e),e=h.next,v=h.next;else if((e=h)===v){p?1===p?a(e=u(i(e),t,n),t,n,r,o,f,2):2===p&&l(e,t,n,r,o,f):a(i(e),t,n,r,o,f,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(m(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(v(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&m(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function c(e,t,n,r){var o=e.prev,i=e,a=e.next;if(m(o,i,a)>=0)return!1;for(var s=o.x<i.x?o.x<a.x?o.x:a.x:i.x<a.x?i.x:a.x,c=o.y<i.y?o.y<a.y?o.y:a.y:i.y<a.y?i.y:a.y,u=o.x>i.x?o.x>a.x?o.x:a.x:i.x>a.x?i.x:a.x,l=o.y>i.y?o.y>a.y?o.y:a.y:i.y>a.y?i.y:a.y,f=g(s,c,t,n,r),p=g(u,l,t,n,r),d=e.prevZ,h=e.nextZ;d&&d.z>=f&&h&&h.z<=p;){if(d!==e.prev&&d!==e.next&&v(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,h!==e.prev&&h!==e.next&&v(o.x,o.y,i.x,i.y,a.x,a.y,h.x,h.y)&&m(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&v(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;h&&h.z<=p;){if(h!==e.prev&&h!==e.next&&v(o.x,o.y,i.x,i.y,a.x,a.y,h.x,h.y)&&m(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function u(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!b(o,a)&&x(o,r,r.next,a)&&_(o,a)&&_(a,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(a.i/n),C(r),C(r.next),r=e=a),r=r.next}while(r!==e);return i(r)}function l(e,t,n,r,o,s){var c=e;do{for(var u=c.next.next;u!==c.prev;){if(c.i!==u.i&&y(c,u)){var l=O(c,u);return c=i(c,c.next),l=i(l,l.next),a(c,t,n,r,o,s),void a(l,t,n,r,o,s)}u=u.next}c=c.next}while(c!==e)}function f(e,t){return e.x-t.x}function p(e,t){if(t=function(e,t){var n,r=t,o=e.x,i=e.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=o&&s>a){if(a=s,s===o){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(o===a)return n;var c,u=n,l=n.x,f=n.y,p=1/0;r=n;do{o>=r.x&&r.x>=l&&o!==r.x&&v(i<f?o:a,i,l,f,i<f?a:o,i,r.x,r.y)&&(c=Math.abs(i-r.y)/(o-r.x),_(r,e)&&(c<p||c===p&&(r.x>n.x||r.x===n.x&&d(n,r)))&&(n=r,p=c)),r=r.next}while(r!==u);return n}(e,t)){var n=O(t,e);i(n,n.next)}}function d(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function g(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function h(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function v(e,t,n,r,o,i,a,s){return(o-a)*(t-s)-(e-a)*(i-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(i-s)-(o-a)*(r-s)>=0}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&x(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(_(e,t)&&_(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||b(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function b(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,n,r){var o=P(m(e,t,n)),i=P(m(e,t,r)),a=P(m(n,r,e)),s=P(m(n,r,t));return o!==i&&a!==s||(!(0!==o||!w(e,n,t))||(!(0!==i||!w(e,r,t))||(!(0!==a||!w(n,e,r))||!(0!==s||!w(n,t,r)))))}function w(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function P(e){return e>0?1:e<0?-1:0}function _(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function O(e,t){var n=new k(e.i,e.x,e.y),r=new k(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function S(e,t,n,r){var o=new k(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function k(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function L(e,t,n,r){for(var o=0,i=t,a=n-r;i<n;i+=r)o+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return o}e.exports=r,e.exports.default=r,r.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,a=Math.abs(L(e,0,i,n));if(o)for(var s=0,c=t.length;s<c;s++){var u=t[s]*n,l=s<c-1?t[s+1]*n:e.length;a-=Math.abs(L(e,u,l,n))}var f=0;for(s=0;s<r.length;s+=3){var p=r[s]*n,d=r[s+1]*n,g=r[s+2]*n;f+=Math.abs((e[p]-e[g])*(e[d+1]-e[p+1])-(e[p]-e[d])*(e[g+1]-e[p+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var a=0;a<t;a++)n.vertices.push(e[o][i][a]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}},function(e,t,n){var r=n(67);e.exports=function(e,t){if(null==e)return{};var n,o,i=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},function(e,t,n){"use strict";e.exports=r,e.exports.default=r;function r(e,t,n,r,o,i){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=r||.25,this.fontFamily=o||"sans-serif",this.fontWeight=i||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(e,t,n,r,o,a,s){for(var c=0;c<t;c++){for(var u=0;u<n;u++)r[u]=e[u*t+c];for(i(r,o,a,s,n),u=0;u<n;u++)e[u*t+c]=o[u]}for(u=0;u<n;u++){for(c=0;c<t;c++)r[c]=e[u*t+c];for(i(r,o,a,s,t),c=0;c<t;c++)e[u*t+c]=Math.sqrt(o[c])}}function i(e,t,n,r,o){n[0]=0,r[0]=-1e20,r[1]=1e20;for(var i=1,a=0;i<o;i++){for(var s=(e[i]+i*i-(e[n[a]]+n[a]*n[a]))/(2*i-2*n[a]);s<=r[a];)a--,s=(e[i]+i*i-(e[n[a]]+n[a]*n[a]))/(2*i-2*n[a]);n[++a]=i,r[a]=s,r[a+1]=1e20}for(i=0,a=0;i<o;i++){for(;r[a+1]<i;)a++;t[i]=(i-n[a])*(i-n[a])+e[n[a]]}}r.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=t.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?1e20:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?1e20:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var a=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(a/this.radius+this.cutoff))))}return n}},function(e,t,n){var r=n(68),o=globalThis.deck||{};if(!o.Layer)throw new Error("@deck.gl/core is not found");e.exports=Object.assign(o,r)},,,,,,,function(e,t,n){var r=n(2);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){var r=n(32);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var o=t&&t.prototype instanceof l?t:l,i=Object.create(o.prototype),a=new P(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return O()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function l(){}function f(){}function p(){}var d={};d[o]=function(){return this};var g=Object.getPrototypeOf,h=g&&g(g(_([])));h&&h!==t&&n.call(h,o)&&(d=h);var v=p.prototype=l.prototype=Object.create(d);function y(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function m(e){var t;this._invoke=function(r,o){function i(){return new Promise((function(t,i){!function t(r,o,i,a){var s=c(e[r],e,o);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,i,a)}),(function(e){t("throw",e,i,a)})):Promise.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return t("throw",e,i,a)}))}a(s.arg)}(r,o,t,i)}))}return t=t?t.then(i,i):i()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=v.constructor=p,p.constructor=f,p[a]=f.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(m.prototype),m.prototype[i]=function(){return this},e.AsyncIterator=m,e.async=function(t,n,r,o){var i=new m(s(t,n,r,o));return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),v[a]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t){},function(e,t){},function(e,t,n){var r=n(35);function o(e){var t,n;function o(t,n){try{var a=e[t](n),s=a.value,c=s instanceof r;Promise.resolve(c?s.wrapped:s).then((function(e){c?o("return"===t?"return":"next",e):i(a.done?"return":"normal",e)}),(function(e){o("throw",e)}))}catch(e){i("throw",e)}}function i(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?o(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(i,a){var s={key:e,arg:r,resolve:i,reject:a,next:null};n?n=n.next=s:(t=n=s,o(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(o.prototype[Symbol.asyncIterator]=function(){return this}),o.prototype.next=function(e){return this._invoke("next",e)},o.prototype.throw=function(e){return this._invoke("throw",e)},o.prototype.return=function(e){return this._invoke("return",e)},e.exports=o},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"filename",(function(){return hr})),n.d(r,"dirname",(function(){return vr})),n.d(r,"join",(function(){return yr}));var o=n(4),i=n.n(o),a=n(5),s=n.n(a),c=n(13),u=n.n(c),l=n(7),f=n.n(l),p=n(11),d=n.n(p),g=n(12),h=n.n(g),v=n(2),y=n.n(v),m=n(0),b=n.n(m),x=n(1),w=n(9);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var S=[0,0,0,255],C={getSourcePosition:{type:"accessor",value:function(e){return e.sourcePosition}},getTargetPosition:{type:"accessor",value:function(e){return e.targetPosition}},getSourceColor:{type:"accessor",value:S},getTargetColor:{type:"accessor",value:S},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},k=function(e){d()(n,e);var t=O(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n  // d: distance on the xy plane\n  // r: ratio of the current point\n  // p: ratio of the peak of the arc\n  // h: height multiplier\n  // z = f(r) = sqrt(r * (p * 2 - r)) * d * h\n  // f(0) = 0\n  // f(1) = dz\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n\n  // sqrt does not deal with negative values, manually flip source and target if delta.z < 0\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\n\n/* Great circle interpolation\n * http://www.movable-type.co.uk/scripts/latlong.html\n */\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\n/* END GREAT CIRCLE */\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      // split at the 180th meridian\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n\n    // common x at longitude=-180\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n\n  // Multiply out width and clamp to limits\n  // mercator pixels are interpreted as screen pixels\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n\n  // extrude\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.picking]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:S},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:S},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}},{key:"updateState",value:function(e){if(f()(y()(n.prototype),"updateState",this).call(this,e),e.changeFlags.extensionsChanged){var t,r=this.context.gl;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.widthUnits,o=n.widthScale,i=n.widthMinPixels,a=n.widthMaxPixels,s=n.greatCircle,c=n.wrapLongitude;this.state.model.setUniforms(t).setUniforms({greatCircle:s,widthUnits:x.UNIT[r],widthScale:o,widthMinPixels:i,widthMaxPixels:a,useShortestPath:c}).draw()}},{key:"_getModel",value:function(e){for(var t=[],n=0;n<50;n++)t=t.concat([n,1,0,n,-1,0]);var r=new w.Model(e,_(_({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:5,attributes:{positions:new Float32Array(t)}}),isInstanced:!0}));return r.setUniforms({numSegments:50}),r}}]),n}(x.Layer);b()(k,"layerName","ArcLayer"),b()(k,"defaultProps",C);var L=n(16),j=n.n(L),A=(n(20),n(14)),E=n.n(A);n(36),n(37);var I="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var M,T;M=new I(4),I!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),T=M;Math.log2;!function(){var e=function(){var e=new I(2);return I!=Float32Array&&(e[0]=0,e[1]=0),e}()}();!function(){var e=function(){var e=new I(3);return I!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}();function R(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var z=Math.PI,F=z/4,D=z/180;function U(e){var t=E()(e,2),n=t[0],r=t[1];R(Number.isFinite(n)),R(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");var o=r*D;return[512*(n*D+z)/(2*z),512*(z+Math.log(Math.tan(F+.5*o)))/(2*z)]}Math.PI;n(38);n(25);Math.PI,Math.PI;function B(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function W(e,t,n){return B(e)?e.map((function(e,r){return W(e,t[r],n)})):n*t+(1-n)*e}var N=new Uint16Array([0,2,1,0,3,2]),G=new Float32Array([0,1,0,0,1,0,1,1]);function V(e,t){if(!t)return function(e){for(var t=new Float64Array(12),n=0;n<e.length;n++)t[3*n+0]=e[n][0],t[3*n+1]=e[n][1],t[3*n+2]=e[n][2]||0;return{vertexCount:6,positions:t,indices:N,texCoords:G}}(e);for(var n=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),r=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),o=Math.ceil(n/t)+1,i=Math.ceil(r/t)+1,a=(o-1)*(i-1)*6,s=new Uint32Array(a),c=new Float32Array(o*i*2),u=new Float64Array(o*i*3),l=0,f=0,p=0;p<o;p++)for(var d=p/(o-1),g=0;g<i;g++){var h=g/(i-1),v=H(e,d,h);u[3*l+0]=v[0],u[3*l+1]=v[1],u[3*l+2]=v[2]||0,c[2*l+0]=d,c[2*l+1]=1-h,p>0&&g>0&&(s[f++]=l-i,s[f++]=l-i-1,s[f++]=l-1,s[f++]=l-i,s[f++]=l-1,s[f++]=l),l++}return{vertexCount:a,positions:u,indices:s,texCoords:c}}function H(e,t,n){return W(W(e[0],e[1],n),W(e[3],e[2],n),t)}var Z="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var X={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:x.COORDINATE_SYSTEM.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}},$=function(e){d()(n,e);var t=Y(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:Z,modules:[x.project32,x.picking]})}},{key:"initializeState",value:function(){var e=this,t=this.getAttributeManager();t.remove(["instancePickingColors"]);t.add({indices:{size:1,isIndexed:!0,update:function(t){return t.value=e.state.mesh.indices},noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:function(t){return t.value=e.state.mesh.positions},noAlloc:!0},texCoords:{size:2,update:function(t){return t.value=e.state.mesh.texCoords},noAlloc:!0}})}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=e.changeFlags,o=this.getAttributeManager();if(r.extensionsChanged){var i,a=this.context.gl;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(a),o.invalidateAll()}if(t.bounds!==n.bounds){var s=this.state.mesh,c=this._createMesh();for(var u in this.state.model.setVertexCount(c.vertexCount),c)s&&s[u]!==c[u]&&o.invalidate(u);this.setState(J({mesh:c},this._getCoordinateUniforms()))}else t._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}},{key:"getPickingInfo",value:function(e){var t=this.props.image,n=e.info;if(!n.color||!t)return n.bitmap=null,n;var r=t,o=r.width,i=r.height;n.index=0;var a,s,c,u,l,f=(a=n.color,s=j()(a,3),c=s[0],u=s[1],l=s[2],[(c+(15&l)/16)/256,(u+(240&l)/256)/256]),p=[Math.floor(f[0]*o),Math.floor(f[1]*i)];return n.bitmap={size:{width:o,height:i},uv:f,pixel:p},n}},{key:"disablePickingIndex",value:function(){this.setState({disablePicking:!0})}},{key:"restorePickingColors",value:function(){this.setState({disablePicking:!1})}},{key:"_updateAutoHighlight",value:function(e){f()(y()(n.prototype),"_updateAutoHighlight",this).call(this,J(J({},e),{},{color:this.encodePickingColor(0)}))}},{key:"_createMesh",value:function(){var e=this.props.bounds,t=e;return q(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),V(t,this.context.viewport.resolution)}},{key:"_getModel",value:function(e){return e?new w.Model(e,J(J({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:4,vertexCount:6}),isInstanced:!1})):null}},{key:"draw",value:function(e){var t=e.uniforms,n=e.moduleParameters,r=this.state,o=r.model,i=r.coordinateConversion,a=r.bounds,s=r.disablePicking,c=this.props,u=c.image,l=c.desaturate,f=c.transparentColor,p=c.tintColor;n.pickingActive&&s||u&&o&&o.setUniforms(t).setUniforms({bitmapTexture:u,desaturate:l,transparentColor:f.map((function(e){return e/255})),tintColor:p.slice(0,3).map((function(e){return e/255})),coordinateConversion:i,bounds:a}).draw()}},{key:"_getCoordinateUniforms",value:function(){var e=x.COORDINATE_SYSTEM.LNGLAT,t=x.COORDINATE_SYSTEM.CARTESIAN,n=x.COORDINATE_SYSTEM.DEFAULT,r=this.props._imageCoordinateSystem;if(r!==n){var o=this.props.bounds;if(!q(o))throw new Error("_imageCoordinateSystem only supports rectangular bounds");var i=this.context.viewport.resolution?e:t;if((r=r===e?e:t)===e&&i===t)return{coordinateConversion:-1,bounds:o};if(r===t&&i===e){var a=U([o[0],o[1]]),s=U([o[2],o[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],s[0],s[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}]),n}(x.Layer);function q(e){return Number.isFinite(e[0])}b()($,"layerName","BitmapLayer"),b()($,"defaultProps",X);var Q=n(10),ee=n.n(Q),te=n(3),ne=n.n(te);function re(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var oe=n(8),ie=n.n(oe),ae=("undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document,Boolean("object"!==("undefined"==typeof process?"undefined":ie()(process))||"[object process]"!==String(process)||process.browser)),se="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),ce=(se&&parseFloat(se[1]),globalThis._parseImageNode),ue="undefined"!=typeof Image,le="undefined"!=typeof ImageBitmap,fe=Boolean(ce),pe=!!ae||fe;function de(e){var t=he(e);if(!t)throw new Error("Not an image");return t}function ge(e){switch(de(e)){case"data":return e;case"image":case"imagebitmap":var t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function he(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"===ie()(e)&&e.data&&e.width&&e.height?"data":null}var ve=/^data:image\/svg\+xml/,ye=/\.svg((\?|#).*)?$/;function me(e){return e&&(ve.test(e)||ye.test(e))}function be(e,t){if(me(t)){var n=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(n=unescape(encodeURIComponent(n)))}catch(e){throw new Error(e.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return xe(e,t)}function xe(e,t){if(me(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}function we(e,t,n){return Pe.apply(this,arguments)}function Pe(){return(Pe=ee()(ne.a.mark((function e(t,n,r){var o,i,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=be(t,r),i=self.URL||self.webkitURL,a="string"!=typeof o&&i.createObjectURL(o),e.prev=3,e.next=6,_e(a||o,n);case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,a&&i.revokeObjectURL(a),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[3,,7,10]])})))).apply(this,arguments)}function _e(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=ee()(ne.a.mark((function e(t,n){var r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=new Image).src=t,!(n.image&&n.image.decode&&r.decode)){e.next=6;break}return e.next=5,r.decode();case 5:return e.abrupt("return",r);case 6:return e.next=8,new Promise((function(e,n){try{r.onload=function(){return e(r)},r.onerror=function(e){return n(new Error("Could not load image ".concat(t,": ").concat(e)))}}catch(e){n(e)}}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Se={},Ce=!0;function ke(e,t,n){return Le.apply(this,arguments)}function Le(){return(Le=ee()(ne.a.mark((function e(t,n,r){var o,i,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!me(r)){e.next=7;break}return e.next=3,we(t,n,r);case 3:i=e.sent,o=i,e.next=8;break;case 7:o=xe(t,r);case 8:return a=n&&n.imagebitmap,e.next=11,je(o,a);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=ee()(ne.a.mark((function e(t){var n,r=arguments;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee(n=r.length>1&&void 0!==r[1]?r[1]:null)&&Ce||(n=null),!n){e.next=13;break}return e.prev=3,e.next=6,createImageBitmap(t,n);case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(3),console.warn(e.t0),Ce=!1;case 13:return e.next=15,createImageBitmap(t);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function Ee(e){for(var t in e||Se)return!1;return!0}function Ie(e){var t=Me(e);return function(e){var t=Me(e);if(!(t.byteLength>=24&&2303741511===t.getUint32(0,!1)))return null;return{mimeType:"image/png",width:t.getUint32(16,!1),height:t.getUint32(20,!1)}}(t)||function(e){var t=Me(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,!1)&&255===t.getUint8(2)))return null;var n=function(){for(var e=new Set([65499,65476,65484,65501,65534]),t=65504;t<65520;++t)e.add(t);var n=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:n}}(),r=n.tableMarkers,o=n.sofMarkers,i=2;for(;i+9<t.byteLength;){var a=t.getUint16(i,!1);if(o.has(a))return{mimeType:"image/jpeg",height:t.getUint16(i+5,!1),width:t.getUint16(i+7,!1)};if(!r.has(a))return null;i+=2,i+=t.getUint16(i,!1)}return null}(t)||function(e){var t=Me(e);if(!(t.byteLength>=10&&1195984440===t.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:t.getUint16(6,!0),height:t.getUint16(8,!0)}}(t)||function(e){var t=Me(e);if(!(t.byteLength>=14&&16973===t.getUint16(0,!1)&&t.getUint32(2,!0)===t.byteLength))return null;return{mimeType:"image/bmp",width:t.getUint32(18,!0),height:t.getUint32(22,!0)}}(t)}function Me(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}function Te(e,t){return Re.apply(this,arguments)}function Re(){return(Re=ee()(ne.a.mark((function e(t,n){var r,o,i;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ie(t)||{},o=r.mimeType,re(i=globalThis._parseImageNode),e.next=5,i(t,o);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(){return(ze=ee()(ne.a.mark((function e(t,n,r){var o,i,a,s,c;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(n=n||{}).image||{},i=o.type||"auto",a=(r||{}).url,s=Fe(i),e.t0=s,e.next="imagebitmap"===e.t0?8:"image"===e.t0?12:"data"===e.t0?16:20;break;case 8:return e.next=10,ke(t,n,a);case 10:return c=e.sent,e.abrupt("break",21);case 12:return e.next=14,we(t,n,a);case 14:return c=e.sent,e.abrupt("break",21);case 16:return e.next=18,Te(t,n);case 18:return c=e.sent,e.abrupt("break",21);case 20:re(!1);case 21:return"data"===i&&(c=ge(c)),e.abrupt("return",c);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(e){switch(e){case"auto":case"data":return function(){if(le)return"imagebitmap";if(ue)return"image";if(pe)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return le||ue||pe;case"imagebitmap":return le;case"image":return ue;case"data":return pe;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}var De={id:"image",module:"images",name:"Images",version:"3.2.5",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(e,t,n){return ze.apply(this,arguments)},tests:[function(e){return Boolean(Ie(new DataView(e)))}],options:{image:{type:"auto",decode:!0}}},Ue=function(e){return"boolean"==typeof e},Be=function(e){return"function"==typeof e},We=function(e){return null!==e&&"object"===ie()(e)},Ne=function(e){return We(e)&&e.constructor==={}.constructor},Ge=function(e){return e&&"function"==typeof e[Symbol.iterator]},Ve=function(e){return e&&"function"==typeof e[Symbol.asyncIterator]},He=function(e){return"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json},Ze=function(e){return"undefined"!=typeof Blob&&e instanceof Blob},Ke=function(e){return function(e){return"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||We(e)&&Be(e.tee)&&Be(e.cancel)&&Be(e.getReader)}(e)||function(e){return We(e)&&Be(e.read)&&Be(e.pipe)&&Ue(e.readable)}(e)};function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xe(e){var t;return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions))}function $e(e){var t,n,r;return re(e,"null loader"),re(Xe(e),"invalid loader"),Array.isArray(e)&&(r=e[1],e=Ye(Ye({},e=e[0]),{},{options:Ye(Ye({},e.options),r)})),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}var qe="",Qe={};function et(e){for(var t in Qe)if(e.startsWith(t)){var n=Qe[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(qe).concat(e)),e}var tt=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,nt=/^([-\w.]+\/[-\w.+]+)/;function rt(e){var t=nt.exec(e);return t?t[1]:e}function ot(e){var t=tt.exec(e);return t?t[1]:""}var it=/\?.*/;function at(e){if(He(e)){var t=ct(e.url||"");return{url:t,type:rt(e.headers.get("content-type")||"")||ot(t)}}return Ze(e)?{url:ct(e.name||""),type:e.type||""}:"string"==typeof e?{url:ct(e),type:ot(e)}:{url:"",type:""}}function st(e){return He(e)?e.headers["content-length"]||-1:Ze(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer?e.byteLength:ArrayBuffer.isView(e)?e.byteLength:-1}function ct(e){return e.replace(it,"")}function ut(e){return lt.apply(this,arguments)}function lt(){return(lt=ee()(ne.a.mark((function e(t){var n,r,o,i,a,s,c;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!He(t)){e.next=2;break}return e.abrupt("return",t);case 2:return n={},(r=st(t))>=0&&(n["content-length"]=String(r)),o=at(t),i=o.url,(a=o.type)&&(n["content-type"]=a),e.next=9,ht(t);case 9:return(s=e.sent)&&(n["x-first-bytes"]=s),"string"==typeof t&&(t=(new TextEncoder).encode(t)),c=new Response(t,{headers:n}),Object.defineProperty(c,"url",{value:i}),e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e){return pt.apply(this,arguments)}function pt(){return(pt=ee()(ne.a.mark((function e(t){var n;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}return e.next=3,dt(t);case 3:throw n=e.sent,new Error(n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e){return gt.apply(this,arguments)}function gt(){return(gt=ee()(ne.a.mark((function e(t){var n,r,o;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): "),e.prev=1,r=t.headers.get("Content-Type"),o=t.statusText,!r.includes("application/json")){e.next=11;break}return e.t0=o,e.t1=" ",e.next=9,t.text();case 9:e.t2=e.sent,o=e.t0+=e.t1.concat.call(e.t1,e.t2);case 11:n=(n+=o).length>60?"".concat(n.slice(0,60),"..."):n,e.next=17;break;case 15:e.prev=15,e.t3=e.catch(1);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function ht(e){return vt.apply(this,arguments)}function vt(){return(vt=ee()(ne.a.mark((function e(t){var n,r,o,i;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=5,"string"!=typeof t){e.next=3;break}return e.abrupt("return","data:,".concat(t.slice(0,n)));case 3:if(!(t instanceof Blob)){e.next=8;break}return r=t.slice(0,5),e.next=7,new Promise((function(e){var t=new FileReader;t.onload=function(t){var n;return e(null==t?void 0:null===(n=t.target)||void 0===n?void 0:n.result)},t.readAsDataURL(r)}));case 7:return e.abrupt("return",e.sent);case 8:if(!(t instanceof ArrayBuffer)){e.next=12;break}return o=t.slice(0,n),i=yt(o),e.abrupt("return","data:base64,".concat(i));case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yt(e){for(var t="",n=new Uint8Array(e),r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}function mt(e,t){return bt.apply(this,arguments)}function bt(){return(bt=ee()(ne.a.mark((function e(t,n){var r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=7;break}return t=et(t),r=n,null!=n&&n.fetch&&"function"!=typeof(null==n?void 0:n.fetch)&&(r=n.fetch),e.next=6,fetch(t,r);case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,ut(t);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xt=n(6),wt=n(15),Pt=n.n(wt);function _t(){return!("object"===("undefined"==typeof process?"undefined":ie()(process))&&"[object process]"===String(process)&&!process.browser)||function(e){if("undefined"!=typeof window&&"object"===ie()(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===ie()(process.versions)&&Boolean(process.versions.electron))return!0;var t="object"===("undefined"==typeof navigator?"undefined":ie()(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)}()}var Ot=_t();function St(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(e){return null}}var Ct=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";i()(this,e),this.storage=St(r),this.id=t,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return s()(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}]),e}();function kt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,o=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));var i=e.width*n,a=e.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(o,");"),"background-size:".concat(i,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),s]}var Lt={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function jt(e){return"string"==typeof e?Lt[e.toUpperCase()]||Lt.WHITE:e}function At(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(e),o=Object.getOwnPropertyNames(r),i=At(o);try{var a=function(){var r=t.value;"function"==typeof e[r]&&(n.find((function(e){return r===e}))||(e[r]=e[r].bind(e)))};for(i.s();!(t=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}}function Mt(e,t){if(!e)throw new Error(t||"Assertion failed")}var Tt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":ie()(process))&&process},Rt=Tt.window||Tt.self||Tt.global,zt=Tt.process||{};console;function Ft(){var e;if(Ot&&Rt.performance)e=Rt.performance.now();else if(zt.hrtime){var t=zt.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}var Dt={debug:Ot&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ut={enabled:!0,level:0};function Bt(){}var Wt={},Nt={once:!0};function Gt(e){for(var t in e)for(var n in e[t])return n||"untitled";return"empty"}var Vt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""},n=t.id;i()(this,e),this.id=n,this.VERSION="8.8.11",this._startTs=Ft(),this._deltaTs=Ft(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Ct("__probe-".concat(this.id,"__"),Ut),this.userData={},this.timeStamp("".concat(this.id," started")),It(this),Object.seal(this)}return s()(e,[{key:"level",get:function(){return this.getLevel()},set:function(e){this.setLevel(e)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Ft()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Ft()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(e){this.level=e}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({level:e}),this}},{key:"assert",value:function(e,t){Mt(e,t)}},{key:"warn",value:function(e){return this._getLogFunction(0,e,Dt.warn,arguments,Nt)}},{key:"error",value:function(e){return this._getLogFunction(0,e,Dt.error,arguments)}},{key:"deprecated",value:function(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}},{key:"removed",value:function(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}},{key:"probe",value:function(e,t){return this._getLogFunction(e,t,Dt.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(e,t){return this._getLogFunction(e,t,Dt.debug,arguments)}},{key:"info",value:function(e,t){return this._getLogFunction(e,t,console.info,arguments)}},{key:"once",value:function(e,t){return this._getLogFunction(e,t,Dt.debug||Dt.info,arguments,Nt)}},{key:"table",value:function(e,t,n){return t?this._getLogFunction(e,t,console.table||Bt,n&&[n],{tag:Gt(t)}):Bt}},{key:"image",value:function(e){var t=e.logLevel,r=e.priority,o=e.image,i=e.message,a=void 0===i?"":i,s=e.scale,c=void 0===s?1:s;return this._shouldLog(t||r)?Ot?function(e){var t=e.image,n=e.message,r=void 0===n?"":n,o=e.scale,i=void 0===o?1:o;if("string"==typeof t){var a=new Image;return a.onload=function(){var e,t=kt(a,r,i);(e=console).log.apply(e,Pt()(t))},a.src=t,Bt}var s=t.nodeName||"";if("img"===s.toLowerCase()){var c;return(c=console).log.apply(c,Pt()(kt(t,r,i))),Bt}if("canvas"===s.toLowerCase()){var u=new Image;return u.onload=function(){var e;return(e=console).log.apply(e,Pt()(kt(u,r,i)))},u.src=t.toDataURL(),Bt}return Bt}({image:o,message:a,scale:c}):function(e){var t=e.image,r=(e.message,e.scale),o=void 0===r?1:r,i=null;try{i=n(64)}catch(e){}if(i)return function(){return i(t,{fit:"box",width:"".concat(Math.round(80*o),"%")}).then((function(e){return console.log(e)}))};return Bt}({image:o,message:a,scale:c}):Bt}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(e){return this._storage.config[e]}},{key:"set",value:function(e,t){this._storage.updateConfiguration(b()({},e,t))}},{key:"time",value:function(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}},{key:"timeEnd",value:function(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(e,t){return this._getLogFunction(e,t,console.timeStamp||Bt)}},{key:"group",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=n=Zt({logLevel:e,message:t,opts:n}),o=r.collapsed;return n.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}},{key:"groupCollapsed",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction(e,"",console.groupEnd||Bt)}},{key:"withGroup",value:function(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return this.isEnabled()&&this.getLevel()>=Ht(e)}},{key:"_getLogFunction",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(e)){var i;o=Zt({logLevel:e,message:t,args:r,opts:o}),Mt(n=n||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Ft();var a=o.tag||o.message;if(o.once){if(Wt[a])return Bt;Wt[a]=Ft()}return t=Kt(this.id,o.message,o),(i=n).bind.apply(i,[console,t].concat(Pt()(o.args)))}return Bt}}]),e}();function Ht(e){if(!e)return 0;var t;switch(ie()(e)){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Mt(Number.isFinite(t)&&t>=0),t}function Zt(e){var t=e.logLevel,n=e.message;e.logLevel=Ht(t);for(var r=e.args?Array.from(e.args):[];r.length&&r.shift()!==n;);switch(e.args=r,ie()(t)){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());var o=ie()(e.message);return Mt("string"===o||"object"===o),Object.assign(e,e.opts)}function Kt(e,t,n){if("string"==typeof t){var r=n.time?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}((s=n.total)<10?"".concat(s.toFixed(2),"ms"):s<100?"".concat(s.toFixed(1),"ms"):s<1e3?"".concat(s.toFixed(0),"ms"):"".concat((s/1e3).toFixed(2),"s")):"";t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),o=t,i=n.color,a=n.background,Ot||"string"!=typeof o||(i&&(i=jt(i),o="[".concat(i,"m").concat(o,"[39m")),a&&(i=jt(a),o="[".concat(a+10,"m").concat(o,"[49m"))),t=o}var o,i,a,s;return t}Vt.VERSION="8.8.11";var Jt=new Vt({id:"loaders.gl"}),Yt=function(){function e(){i()(this,e)}return s()(e,[{key:"log",value:function(){return function(){}}},{key:"info",value:function(){return function(){}}},{key:"warn",value:function(){return function(){}}},{key:"error",value:function(){return function(){}}}]),e}(),Xt={fetch:null,mimeType:void 0,nothrow:!1,log:new(function(){function e(){i()(this,e),Object(xt.a)(this,"console",void 0),this.console=console}return s()(e,[{key:"log",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.log).bind.apply(e,[this.console].concat(n))}},{key:"info",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.info).bind.apply(e,[this.console].concat(n))}},{key:"warn",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.warn).bind.apply(e,[this.console].concat(n))}},{key:"error",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.error).bind.apply(e,[this.console].concat(n))}}]),e}()),CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ae,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},$t={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function en(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?en(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nn(){globalThis.loaders=globalThis.loaders||{};var e=globalThis.loaders;return e._state=e._state||{},e._state}var rn=function(){var e=nn();return e.globalOptions=e.globalOptions||tn({},Xt),e.globalOptions};function on(e,t,n,r){return n=n||[],function(e,t){sn(e,null,Xt,$t,t);var n,r=qt(t);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=e&&e[o.id]||{},a=o.options&&o.options[o.id]||{},s=o.deprecatedOptions&&o.deprecatedOptions[o.id]||{};sn(i,o.id,a,s,t)}}catch(e){r.e(e)}finally{r.f()}}(e,n=Array.isArray(n)?n:[n]),un(t,e,r)}function an(e,t){var n=rn(),r=e||n;return"function"==typeof r.fetch?r.fetch:We(r.fetch)?function(e){return mt(e,r)}:null!=t&&t.fetch?null==t?void 0:t.fetch:mt}function sn(e,t,n,r,o){var i=t||"Top level",a=t?"".concat(t,"."):"";for(var s in e){var c=!t&&We(e[s]);if(!(s in n||"baseUri"===s&&!t||"workerUrl"===s&&t))if(s in r)Jt.warn("".concat(i," loader option '").concat(a).concat(s,"' no longer supported, use '").concat(r[s],"'"))();else if(!c){var u=cn(s,o);Jt.warn("".concat(i," loader option '").concat(a).concat(s,"' not recognized. ").concat(u))()}}}function cn(e,t){var n,r=e.toLowerCase(),o="",i=qt(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;for(var s in a.options){if(e===s)return"Did you mean '".concat(a.id,".").concat(s,"'?");var c=s.toLowerCase();(r.startsWith(c)||c.startsWith(r))&&(o=o||"Did you mean '".concat(a.id,".").concat(s,"'?"))}}}catch(e){i.e(e)}finally{i.f()}return o}function un(e,t,n){var r=tn({},e.options||{});return function(e,t){!t||"baseUri"in e||(e.baseUri=t)}(r,n),null===r.log&&(r.log=new Yt),ln(r,rn()),ln(r,t),r}function ln(e,t){for(var n in t)if(n in t){var r=t[n];Ne(r)&&Ne(e[n])?e[n]=tn(tn({},e[n]),t[n]):e[n]=t[n]}}function fn(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}function pn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"3.2.5";fn(e,"no worker provided");var n=e.version;return!(!t||!n)}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;var dn="object"!==("undefined"==typeof process?"undefined":ie()(process))||"[object process]"!==String(process)||process.browser,gn="undefined"!=typeof window&&void 0!==window.orientation,hn="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),vn=(hn&&parseFloat(hn[1]),function e(){i()(this,e)}),yn=new Map;function mn(e){fn(e.source&&!e.url||!e.source&&e.url);var t=yn.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return bn((t=e,"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var t}(e.url),yn.set(e.url,t)),e.source&&(t=bn(e.source),yn.set(e.source,t))),fn(t),t}function bn(e){var t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function xn(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}var wn=function(){},Pn=function(){function e(t){i()(this,e),Object(xt.a)(this,"name",void 0),Object(xt.a)(this,"source",void 0),Object(xt.a)(this,"url",void 0),Object(xt.a)(this,"terminated",!1),Object(xt.a)(this,"worker",void 0),Object(xt.a)(this,"onMessage",void 0),Object(xt.a)(this,"onError",void 0),Object(xt.a)(this,"_loadableURL","");var n=t.name,r=t.source,o=t.url;fn(r||o),this.name=n,this.source=r,this.url=o,this.onMessage=wn,this.onError=function(e){return console.log(e)},this.worker=dn?this._createBrowserWorker():this._createNodeWorker()}return s()(e,[{key:"destroy",value:function(){this.onMessage=wn,this.onError=wn,this.worker.terminate(),this.terminated=!0}},{key:"isRunning",get:function(){return Boolean(this.onMessage)}},{key:"postMessage",value:function(e,t){t=t||function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,o=r||new Set;if(t){if(xn(t))o.add(t);else if(xn(t.buffer))o.add(t.buffer);else if(ArrayBuffer.isView(t));else if(n&&"object"===ie()(t))for(var i in t)e(t[i],n,o)}else;return void 0===r?Array.from(o):[]}(e),this.worker.postMessage(e,t)}},{key:"_getErrorFromErrorEvent",value:function(e){var t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}},{key:"_createBrowserWorker",value:function(){var e=this;this._loadableURL=mn({source:this.source,url:this.url});var t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=function(t){t.data?e.onMessage(t.data):e.onError(new Error("No data received"))},t.onerror=function(t){e.onError(e._getErrorFromErrorEvent(t)),e.terminated=!0},t.onmessageerror=function(e){return console.error(e)},t}},{key:"_createNodeWorker",value:function(){var e,t=this;if(this.url){var n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new vn(n,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new vn(this.source,{eval:!0})}return e.on("message",(function(e){t.onMessage(e)})),e.on("error",(function(e){t.onError(e)})),e.on("exit",(function(e){})),e}}],[{key:"isSupported",value:function(){return"undefined"!=typeof Worker&&dn||void 0!==ie()(vn)}}]),e}(),_n=function(){function e(t,n){var r=this;i()(this,e),Object(xt.a)(this,"name",void 0),Object(xt.a)(this,"workerThread",void 0),Object(xt.a)(this,"isRunning",!0),Object(xt.a)(this,"result",void 0),Object(xt.a)(this,"_resolve",(function(){})),Object(xt.a)(this,"_reject",(function(){})),this.name=t,this.workerThread=n,this.result=new Promise((function(e,t){r._resolve=e,r._reject=t}))}return s()(e,[{key:"postMessage",value:function(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}},{key:"done",value:function(e){fn(this.isRunning),this.isRunning=!1,this._resolve(e)}},{key:"error",value:function(e){fn(this.isRunning),this.isRunning=!1,this._reject(e)}}]),e}();function On(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?On(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):On(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cn=function(){function e(t){i()(this,e),Object(xt.a)(this,"name","unnamed"),Object(xt.a)(this,"source",void 0),Object(xt.a)(this,"url",void 0),Object(xt.a)(this,"maxConcurrency",1),Object(xt.a)(this,"maxMobileConcurrency",1),Object(xt.a)(this,"onDebug",(function(){})),Object(xt.a)(this,"reuseWorkers",!0),Object(xt.a)(this,"props",{}),Object(xt.a)(this,"jobQueue",[]),Object(xt.a)(this,"idleQueue",[]),Object(xt.a)(this,"count",0),Object(xt.a)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}var t,n;return s()(e,[{key:"destroy",value:function(){this.idleQueue.forEach((function(e){return e.destroy()})),this.isDestroyed=!0}},{key:"setProps",value:function(e){this.props=Sn(Sn({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}},{key:"startJob",value:(n=ee()(ne.a.mark((function e(t){var n,r,o,i=this,a=arguments;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:function(e,t,n){return e.done(n)},r=a.length>2&&void 0!==a[2]?a[2]:function(e,t){return e.error(t)},o=new Promise((function(e){return i.jobQueue.push({name:t,onMessage:n,onError:r,onStart:e}),i})),this._startQueuedJob(),e.next=6,o;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_startQueuedJob",value:(t=ee()(ne.a.mark((function e(){var t,n,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobQueue.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this._getAvailableWorker()){e.next=5;break}return e.abrupt("return");case 5:if(!(n=this.jobQueue.shift())){e.next=18;break}return this.onDebug({message:"Starting job",name:n.name,workerThread:t,backlog:this.jobQueue.length}),r=new _n(n.name,t),t.onMessage=function(e){return n.onMessage(r,e.type,e.payload)},t.onError=function(e){return n.onError(r,e)},n.onStart(r),e.prev=12,e.next=15,r.result;case 15:return e.prev=15,this.returnWorkerToQueue(t),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[12,,15,18]])}))),function(){return t.apply(this,arguments)})},{key:"returnWorkerToQueue",value:function(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;var e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Pn({name:e,source:this.source,url:this.url})}return null}},{key:"_getMaxConcurrency",value:function(){return gn?this.maxMobileConcurrency:this.maxConcurrency}}],[{key:"isSupported",value:function(){return Pn.isSupported()}}]),e}();function kn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ln(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ln(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var En={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:function(){}},In=function(){function e(t){i()(this,e),Object(xt.a)(this,"props",void 0),Object(xt.a)(this,"workerPools",new Map),this.props=An({},En),this.setProps(t),this.workerPools=new Map}return s()(e,[{key:"destroy",value:function(){var e,t=kn(this.workerPools.values());try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(e){t.e(e)}finally{t.f()}this.workerPools=new Map}},{key:"setProps",value:function(e){this.props=An(An({},this.props),e);var t,n=kn(this.workerPools.values());try{for(n.s();!(t=n.n()).done;){t.value.setProps(this._getWorkerPoolProps())}}catch(e){n.e(e)}finally{n.f()}}},{key:"getWorkerPool",value:function(e){var t=e.name,n=e.source,r=e.url,o=this.workerPools.get(t);return o||((o=new Cn({name:t,source:n,url:r})).setProps(this._getWorkerPoolProps()),this.workerPools.set(t,o)),o}},{key:"_getWorkerPoolProps",value:function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}],[{key:"isSupported",value:function(){return Pn.isSupported()}},{key:"getWorkerFarm",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e._workerFarm=e._workerFarm||new e({}),e._workerFarm.setProps(t),e._workerFarm}}]),e}();Object(xt.a)(In,"_workerFarm",void 0);function Mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t[e.id]||{},r="".concat(e.id,"-worker.js"),o=n.workerUrl;if(o||"compression"!==e.id||(o=t.workerUrl),"test"===t._workerType&&(o="modules/".concat(e.module,"/dist/").concat(r)),!o){var i=e.version;"latest"===i&&(i="latest");var a=i?"@".concat(i):"";o="https://unpkg.com/@loaders.gl/".concat(e.module).concat(a,"/dist/").concat(r)}return fn(o),o}function Tn(e,t){return!!In.isSupported()&&(!!(dn||null!=t&&t._nodeWorkers)&&(e.worker&&(null==t?void 0:t.worker)))}function Rn(e,t,n,r,o){return zn.apply(this,arguments)}function zn(){return(zn=ee()(ne.a.mark((function e(t,n,r,o,i){var a,s,c,u,l,f;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,s=Mn(t,r),c=In.getWorkerFarm(r),u=c.getWorkerPool({name:a,url:s}),r=JSON.parse(JSON.stringify(r)),o=JSON.parse(JSON.stringify(o||{})),e.next=8,u.startJob("process-on-worker",Fn.bind(null,i));case 8:return(l=e.sent).postMessage("process",{input:n,options:r,context:o}),e.next=12,l.result;case 12:return f=e.sent,e.next=15,f.result;case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fn(e,t,n,r){return Dn.apply(this,arguments)}function Dn(){return(Dn=ee()(ne.a.mark((function e(t,n,r,o){var i,a,s,c,u;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="done"===e.t0?3:"error"===e.t0?5:"process"===e.t0?7:20;break;case 3:return n.done(o),e.abrupt("break",21);case 5:return n.error(new Error(o.error)),e.abrupt("break",21);case 7:return i=o.id,a=o.input,s=o.options,e.prev=8,e.next=11,t(a,s);case 11:c=e.sent,n.postMessage("done",{id:i,result:c}),e.next=19;break;case 15:e.prev=15,e.t1=e.catch(8),u=e.t1 instanceof Error?e.t1.message:"unknown error",n.postMessage("error",{id:i,error:u});case 19:return e.abrupt("break",21);case 20:console.warn("parse-with-worker unknown message ".concat(r));case 21:case"end":return e.stop()}}),e,null,[[8,15]])})))).apply(this,arguments)}var Un=n(19),Bn=n.n(Un);n(26);function Wn(e){return e&&"object"===ie()(e)&&e.isBuffer}function Nn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vn(e){if(Wn(e))return Wn(t=e)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){var n=e;return(new TextEncoder).encode(n).buffer}if(e&&"object"===ie()(e)&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function Hn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=t.map((function(e){return e instanceof ArrayBuffer?new Uint8Array(e):e})),i=o.reduce((function(e,t){return e+t.byteLength}),0),a=new Uint8Array(i),s=0,c=Nn(o);try{for(c.s();!(r=c.n()).done;){var u=r.value;a.set(u,s),s+=u.byteLength}}catch(e){c.e(e)}finally{c.f()}return a.buffer}function Zn(e){return Kn.apply(this,arguments)}function Kn(){return(Kn=ee()(ne.a.mark((function e(t){var n,r,o,i,a,s,c;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=!1,o=!1,e.prev=3,a=Bn()(t);case 5:return e.next=7,a.next();case 7:if(!(r=!(s=e.sent).done)){e.next=13;break}c=s.value,n.push(c);case 10:r=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),o=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==a.return){e.next=24;break}return e.next=24,a.return();case 24:if(e.prev=24,!o){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",Hn.apply(void 0,n));case 30:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])})))).apply(this,arguments)}var Jn=ne.a.mark(Yn);function Yn(e,t){var n,r,o,i,a;return ne.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=(null==t?void 0:t.chunkSize)||262144,r=0,o=new TextEncoder;case 3:if(!(r<e.length)){s.next=11;break}return i=Math.min(e.length-r,n),a=e.slice(r,r+i),r+=i,s.next=9,o.encode(a);case 9:s.next=3;break;case 11:case"end":return s.stop()}}),Jn)}var Xn=ne.a.mark($n);function $n(e){var t,n,r,o,i,a,s,c=arguments;return ne.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:t=c.length>1&&void 0!==c[1]?c[1]:{},n=t.chunkSize,r=void 0===n?262144:n,o=0;case 3:if(!(o<e.byteLength)){u.next=14;break}return i=Math.min(e.byteLength-o,r),a=new ArrayBuffer(i),s=new Uint8Array(e,o,i),new Uint8Array(a).set(s),o+=i,u.next=12,a;case 12:u.next=3;break;case 14:case"end":return u.stop()}}),Xn)}var qn=n(17),Qn=n.n(qn),er=n(18),tr=n.n(er);function nr(){return(nr=tr()(ne.a.mark((function e(t,n){var r,o,i,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(null==n?void 0:n.chunkSize)||1048576,o=0;case 2:if(!(o<t.size)){e.next=12;break}return i=o+r,e.next=6,Qn()(t.slice(o,i).arrayBuffer());case 6:return a=e.sent,o=i,e.next=10,a;case 10:e.next=2;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rr(e,t){return ae?function(e,t){return or.apply(this,arguments)}(e,t):function(e,t){return ir.apply(this,arguments)}(e,t)}function or(){return(or=tr()(ne.a.mark((function e(t,n){var r,o,i,a,s,c;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.getReader(),e.prev=1;case 2:return i=o||r.read(),null!=n&&n._streamReadAhead&&(o=r.read()),e.next=7,Qn()(i);case 7:if(a=e.sent,s=a.done,c=a.value,!s){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,Vn(c);case 14:e.next=2;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),r.releaseLock();case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}function ir(){return(ir=tr()(ne.a.mark((function e(t,n){var r,o,i,a,s,c;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,o=!1,e.prev=2,a=Bn()(t);case 4:return e.next=6,Qn()(a.next());case 6:if(!(r=!(s=e.sent).done)){e.next=13;break}return c=s.value,e.next=10,Vn(c);case 10:r=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),o=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==a.return){e.next=24;break}return e.next=24,Qn()(a.return());case 24:if(e.prev=24,!o){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})))).apply(this,arguments)}function ar(e,t){if("string"==typeof e)return Yn(e,t);if(e instanceof ArrayBuffer)return $n(e,t);if(Ze(e))return function(e,t){return nr.apply(this,arguments)}(e,t);if(Ke(e))return rr(e,t);if(He(e))return rr(e.body,t);throw new Error("makeIterator")}var sr="Cannot convert supplied data type";function cr(e,t,n){if(t.text&&"string"==typeof e)return e;var r;if((r=e)&&"object"===ie()(r)&&r.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){var o=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(o):o}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);var i=e.buffer,a=e.byteLength||e.length;return 0===e.byteOffset&&a===i.byteLength||(i=i.slice(e.byteOffset,e.byteOffset+a)),i}throw new Error(sr)}function ur(e,t,n){return lr.apply(this,arguments)}function lr(){return(lr=ee()(ne.a.mark((function e(t,n,r){var o,i;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t instanceof ArrayBuffer||ArrayBuffer.isView(t),"string"!=typeof t&&!o){e.next=3;break}return e.abrupt("return",cr(t,n));case 3:if(!Ze(t)){e.next=7;break}return e.next=6,ut(t);case 6:t=e.sent;case 7:if(!He(t)){e.next=21;break}return i=t,e.next=11,ft(i);case 11:if(!n.binary){e.next=17;break}return e.next=14,i.arrayBuffer();case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,i.text();case 19:e.t0=e.sent;case 20:return e.abrupt("return",e.t0);case 21:if(Ke(t)&&(t=ar(t,r)),!Ge(t)&&!Ve(t)){e.next=24;break}return e.abrupt("return",Zn(t));case 24:throw new Error(sr);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)return n;var r=pr({fetch:an(t,e)},e);return Array.isArray(r.loaders)||(r.loaders=null),r}function gr(e,t){if(!t&&e&&!Array.isArray(e))return e;var n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){var r=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[].concat(Pt()(n),Pt()(r)):r}return n&&n.length?n:null}function hr(e){var t=e&&e.lastIndexOf("/");return t>=0?e.substr(t+1):""}function vr(e){var t=e&&e.lastIndexOf("/");return t>=0?e.substr(0,t):""}function yr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="/";return(t=t.map((function(e,n){return n&&(e=e.replace(new RegExp("^".concat(r)),"")),n!==t.length-1&&(e=e.replace(new RegExp("".concat(r,"$")),"")),e}))).join(r)}n(22),n(34);function mr(){return!("object"===("undefined"==typeof process?"undefined":ie()(process))&&"[object process]"===String(process)&&!process.browser)||function(e){if("undefined"!=typeof window&&"object"===ie()(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===ie()(process.versions)&&Boolean(process.versions.electron))return!0;var t="object"===("undefined"==typeof navigator?"undefined":ie()(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)}()}mr();function br(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(e){return null}}var xr,wr=function(){function e(t){i()(this,e);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(xt.a)(this,"storage",void 0),Object(xt.a)(this,"id",void 0),Object(xt.a)(this,"config",{}),this.storage=br(r),this.id=t,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return s()(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}]),e}();function Pr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,o=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));var i=e.width*n,a=e.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(o,");"),"background-size:".concat(i,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),s]}function _r(e){return"string"==typeof e?xr[e.toUpperCase()]||xr.WHITE:e}function Or(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Sr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Sr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cr(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(e),o=Object.getOwnPropertyNames(r),i=Or(o);try{var a=function(){var r=t.value;"function"==typeof e[r]&&(n.find((function(e){return r===e}))||(e[r]=e[r].bind(e)))};for(i.s();!(t=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}}function kr(e,t){if(!e)throw new Error(t||"Assertion failed")}!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(xr||(xr={}));var Lr={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":ie()(process))&&process},jr=(globalThis,Lr.window||Lr.self||Lr.global),Ar=Lr.process||{};console;function Er(){var e,t,n;if(mr&&"performance"in jr)e=null==jr?void 0:null===(t=jr.performance)||void 0===t?void 0:null===(n=t.now)||void 0===n?void 0:n.call(t);else if("hrtime"in Ar){var r,o=null==Ar?void 0:null===(r=Ar.hrtime)||void 0===r?void 0:r.call(Ar);e=1e3*o[0]+o[1]/1e6}else e=Date.now();return e}var Ir={debug:mr&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Mr={enabled:!0,level:0};function Tr(){}var Rr={},zr={once:!0},Fr=function(){function e(){i()(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""},n=t.id;Object(xt.a)(this,"id",void 0),Object(xt.a)(this,"VERSION","8.8.11"),Object(xt.a)(this,"_startTs",Er()),Object(xt.a)(this,"_deltaTs",Er()),Object(xt.a)(this,"_storage",void 0),Object(xt.a)(this,"userData",{}),Object(xt.a)(this,"LOG_THROTTLE_TIMEOUT",0),this.id=n,this._storage=new wr("__probe-".concat(this.id,"__"),Mr),this.userData={},this.timeStamp("".concat(this.id," started")),Cr(this),Object.seal(this)}return s()(e,[{key:"level",get:function(){return this.getLevel()},set:function(e){this.setLevel(e)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Er()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Er()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(e){this.level=e}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({level:e}),this}},{key:"get",value:function(e){return this._storage.config[e]}},{key:"set",value:function(e,t){this._storage.updateConfiguration(b()({},e,t))}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"assert",value:function(e,t){kr(e,t)}},{key:"warn",value:function(e){return this._getLogFunction(0,e,Ir.warn,arguments,zr)}},{key:"error",value:function(e){return this._getLogFunction(0,e,Ir.error,arguments)}},{key:"deprecated",value:function(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}},{key:"removed",value:function(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}},{key:"probe",value:function(e,t){return this._getLogFunction(e,t,Ir.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(e,t){return this._getLogFunction(e,t,Ir.debug,arguments)}},{key:"info",value:function(e,t){return this._getLogFunction(e,t,console.info,arguments)}},{key:"once",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return this._getLogFunction(e,t,Ir.debug||Ir.info,arguments,zr)}},{key:"table",value:function(e,t,n){return t?this._getLogFunction(e,t,console.table||Tr,n&&[n],{tag:Br(t)}):Tr}},{key:"image",value:function(e){var t=e.logLevel,r=e.priority,o=e.image,i=e.message,a=void 0===i?"":i,s=e.scale,c=void 0===s?1:s;return this._shouldLog(t||r)?mr?function(e){var t=e.image,n=e.message,r=void 0===n?"":n,o=e.scale,i=void 0===o?1:o;if("string"==typeof t){var a=new Image;return a.onload=function(){var e,t=Pr(a,r,i);(e=console).log.apply(e,Pt()(t))},a.src=t,Tr}var s=t.nodeName||"";if("img"===s.toLowerCase()){var c;return(c=console).log.apply(c,Pt()(Pr(t,r,i))),Tr}if("canvas"===s.toLowerCase()){var u=new Image;return u.onload=function(){var e;return(e=console).log.apply(e,Pt()(Pr(u,r,i)))},u.src=t.toDataURL(),Tr}return Tr}({image:o,message:a,scale:c}):function(e){var t=e.image,r=(e.message,e.scale),o=void 0===r?1:r,i=null;try{i=n(65)}catch(e){}if(i)return function(){return i(t,{fit:"box",width:"".concat(Math.round(80*o),"%")}).then((function(e){return console.log(e)}))};return Tr}({image:o,message:a,scale:c}):Tr}},{key:"time",value:function(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}},{key:"timeEnd",value:function(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(e,t){return this._getLogFunction(e,t,console.timeStamp||Tr)}},{key:"group",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=Ur({logLevel:e,message:t,opts:n}),o=n.collapsed;return r.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}},{key:"groupCollapsed",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction(e,"",console.groupEnd||Tr)}},{key:"withGroup",value:function(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return this.isEnabled()&&this.getLevel()>=Dr(e)}},{key:"_getLogFunction",value:function(e,t,n,r,o){if(this._shouldLog(e)){var i;o=Ur({logLevel:e,message:t,args:r,opts:o}),kr(n=n||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Er();var a=o.tag||o.message;if(o.once){if(Rr[a])return Tr;Rr[a]=Er()}return t=function(e,t,n){if("string"==typeof t){var r=n.time?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}((s=n.total)<10?"".concat(s.toFixed(2),"ms"):s<100?"".concat(s.toFixed(1),"ms"):s<1e3?"".concat(s.toFixed(0),"ms"):"".concat((s/1e3).toFixed(2),"s")):"";t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),o=t,i=n.color,a=n.background,mr||"string"!=typeof o||(i&&(i=_r(i),o="[".concat(i,"m").concat(o,"[39m")),a&&(i=_r(a),o="[".concat(a+10,"m").concat(o,"[49m"))),t=o}var o,i,a;var s;return t}(this.id,o.message,o),(i=n).bind.apply(i,[console,t].concat(Pt()(o.args)))}return Tr}}]),e}();function Dr(e){if(!e)return 0;var t;switch(ie()(e)){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return kr(Number.isFinite(t)&&t>=0),t}function Ur(e){var t=e.logLevel,n=e.message;e.logLevel=Dr(t);for(var r=e.args?Array.from(e.args):[];r.length&&r.shift()!==n;);switch(ie()(t)){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());var o=ie()(e.message);return kr("string"===o||"object"===o),Object.assign(e,{args:r},e.opts)}function Br(e){for(var t in e)for(var n in e[t])return n||"untitled";return"empty"}Object(xt.a)(Fr,"VERSION","8.8.11");var Wr=new Fr({id:"loaders.gl"});var Nr=function(){var e=nn();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function Gr(){return Nr()}function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Kr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Kr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jr,Yr=/\.([^.]+)$/;function Xr(e){return $r.apply(this,arguments)}function $r(){return($r=ee()(ne.a.mark((function e(t){var n,r,o,i,a=arguments;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:[],r=a.length>2?a[2]:void 0,o=a.length>3?a[3]:void 0,eo(t)){e.next=5;break}return e.abrupt("return",null);case 5:if(!(i=qr(t,n,Hr(Hr({},r),{},{nothrow:!0}),o))){e.next=8;break}return e.abrupt("return",i);case 8:if(!Ze(t)){e.next=13;break}return e.next=11,t.slice(0,10).arrayBuffer();case 11:t=e.sent,i=qr(t,n,r,o);case 13:if(i||null!=r&&r.nothrow){e.next=15;break}throw new Error(to(t));case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!eo(e))return null;if(t&&!Array.isArray(t))return $e(t);var o,i=[];(t&&(i=i.concat(t)),null!=n&&n.ignoreRegisteredLoaders)||(o=i).push.apply(o,Pt()(Gr()));no(i);var a=Qr(e,i,n,r);if(!(a||null!=n&&n.nothrow))throw new Error(to(e));return a}function Qr(e,t,n,r){var o,i=at(e),a=i.url,s=i.type,c=a||(null==r?void 0:r.url),u=null,l="";(null!=n&&n.mimeType&&(u=ro(t,null==n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null==n?void 0:n.mimeType)),u=u||function(e,t){var n=t&&Yr.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();var n,r=Zr(e);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=Zr(i.extensions);try{for(a.s();!(o=a.n()).done;){if(o.value.toLowerCase()===t)return i}}catch(e){a.e(e)}finally{a.f()}}}catch(e){r.e(e)}finally{r.f()}return null}(e,r):null}(t,c),l=l||(u?"matched url ".concat(c):""),u=u||ro(t,s),l=l||(u?"matched MIME type ".concat(s):""),u=u||function(e,t){if(!t)return null;var n,r=Zr(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if("string"==typeof t){if(oo(t,o))return o}else if(ArrayBuffer.isView(t)){if(io(t.buffer,t.byteOffset,o))return o}else if(t instanceof ArrayBuffer){if(io(t,0,o))return o}}}catch(e){r.e(e)}finally{r.f()}return null}(t,e),l=l||(u?"matched initial data ".concat(ao(e)):""),u=u||ro(t,null==n?void 0:n.fallbackMimeType),l=l||(u?"matched fallback MIME type ".concat(s):""))&&Wr.log(1,"selectLoader selected ".concat(null===(o=u)||void 0===o?void 0:o.name,": ").concat(l,"."));return u}function eo(e){return!(e instanceof Response&&204===e.status)}function to(e){var t=at(e),n=t.url,o=t.type,i="No valid loader found (";i+=n?"".concat(r.filename(n),", "):"no url provided, ",i+="MIME type: ".concat(o?'"'.concat(o,'"'):"not provided",", ");var a=e?ao(e):"";return i+=a?' first bytes: "'.concat(a,'"'):"first bytes: not available",i+=")"}function no(e){var t,n=Zr(e);try{for(n.s();!(t=n.n()).done;){$e(t.value)}}catch(e){n.e(e)}finally{n.f()}}function ro(e,t){var n,r=Zr(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.mimeTypes&&o.mimeTypes.includes(t))return o;if(t==="application/x.".concat(o.id))return o}}catch(e){r.e(e)}finally{r.f()}return null}function oo(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some((function(t){return e.startsWith(t)}))}function io(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((function(r){return function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;for(var r=new Uint8Array(e),o=new Uint8Array(t),i=0;i<r.length;++i)if(r[i]!==o[i])return!1;return!0}(r,e,r.byteLength);switch(ie()(r)){case"function":return r(e,n);case"string":var o=so(e,t,r.length);return r===o;default:return!1}}(e,t,n,r)}))}function ao(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return so(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){var n=0;return so(e,n,t)}return""}function so(e,t,n){if(e.byteLength<t+n)return"";for(var r=new DataView(e),o="",i=0;i<n;i++)o+=String.fromCharCode(r.getUint8(t+i));return o}function co(e,t,n,r){return uo.apply(this,arguments)}function uo(){return(uo=ee()(ne.a.mark((function e(t,n,r,o){var i,a,s,c;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fn(!o||"object"===ie()(o)),!n||Array.isArray(n)||Xe(n)||(o=void 0,r=n,n=void 0),e.next=4,t;case 4:return t=e.sent,r=r||{},i=at(t),a=i.url,s=gr(n,o),e.next=11,Xr(t,s,r);case 11:if(c=e.sent){e.next=14;break}return e.abrupt("return",null);case 14:return r=on(r,c,s,a),o=dr({url:a,parse:co,loaders:s},r,o),e.next=18,lo(c,t,r,o);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lo(e,t,n,r){return fo.apply(this,arguments)}function fo(){return(fo=ee()(ne.a.mark((function e(t,n,r,o){var i,a,s,c,u,l,f,p;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pn(t),He(n)&&(a=(i=n).ok,s=i.redirected,c=i.status,u=i.statusText,l=i.type,f=i.url,p=Object.fromEntries(i.headers.entries()),o.response={headers:p,ok:a,redirected:s,status:c,statusText:u,type:l,url:f}),e.next=4,ur(n,t,r);case 4:if(n=e.sent,!t.parseTextSync||"string"!=typeof n){e.next=8;break}return r.dataType="text",e.abrupt("return",t.parseTextSync(n,r,o,t));case 8:if(!Tn(t,r)){e.next=12;break}return e.next=11,Rn(t,n,r,o,co);case 11:return e.abrupt("return",e.sent);case 12:if(!t.parseText||"string"!=typeof n){e.next=16;break}return e.next=15,t.parseText(n,r,o,t);case 15:return e.abrupt("return",e.sent);case 16:if(!t.parse){e.next=20;break}return e.next=19,t.parse(n,r,o,t);case 19:return e.abrupt("return",e.sent);case 20:throw fn(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function po(){return(po=ee()(ne.a.mark((function e(t,n,r,o){var i,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(n)||Xe(n)||(void 0,r=n,n=void 0),i=an(r),a=t,"string"!=typeof t){e.next=7;break}return e.next=6,i(t);case 6:a=e.sent;case 7:if(!Ze(t)){e.next=11;break}return e.next=10,i(t);case 10:a=e.sent;case 11:return e.next=13,co(a,n,r);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function go(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ho(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ho(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mo=function(){},bo=(Jr={},b()(Jr,10241,9987),b()(Jr,10240,9729),b()(Jr,10242,33071),b()(Jr,10243,33071),Jr);function xo(e){return e&&(e.id||e.url)}function wo(e,t,n){for(var r=0;r<t.length;r++){var o=t[r],i=o.icon,a=o.xOffset;e[xo(i)]=yo(yo({},i),{},{x:a,y:n})}}var Po=function(){function e(t,n){var r=n.onUpdate,o=void 0===r?mo:r,a=n.onError,s=void 0===a?mo:a;i()(this,e),b()(this,"gl",void 0),b()(this,"onUpdate",void 0),b()(this,"onError",void 0),b()(this,"_loadOptions",null),b()(this,"_texture",null),b()(this,"_externalTexture",null),b()(this,"_mapping",{}),b()(this,"_textureParameters",null),b()(this,"_pendingCount",0),b()(this,"_autoPacking",!1),b()(this,"_xOffset",0),b()(this,"_yOffset",0),b()(this,"_rowHeight",0),b()(this,"_buffer",4),b()(this,"_canvasWidth",1024),b()(this,"_canvasHeight",0),b()(this,"_canvas",null),this.gl=t,this.onUpdate=o,this.onError=s}return s()(e,[{key:"finalize",value:function(){var e;null===(e=this._texture)||void 0===e||e.delete()}},{key:"getTexture",value:function(){return this._texture||this._externalTexture}},{key:"getIconMapping",value:function(e){var t=this._autoPacking?xo(e):e;return this._mapping[t]||{}}},{key:"setProps",value:function(e){var t,n=e.loadOptions,r=e.autoPacking,o=e.iconAtlas,i=e.iconMapping,a=e.textureParameters;(n&&(this._loadOptions=n),void 0!==r&&(this._autoPacking=r),i&&(this._mapping=i),o)&&(null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=o);a&&(this._textureParameters=a)}},{key:"isLoaded",get:function(){return 0===this._pendingCount}},{key:"packIcons",value:function(e,t){if(this._autoPacking&&"undefined"!=typeof document){var n,r,o,i,a,s,c,u=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};var r,o={},i=Object(x.createIterable)(e),a=i.iterable,s=i.objectInfo,c=go(a);try{for(c.s();!(r=c.n()).done;){var u=r.value;s.index++;var l=t(u,s),f=xo(l);if(!l)throw new Error("Icon is missing.");if(!l.url)throw new Error("Icon url is missing.");o[f]||n[f]&&l.url===n[f].url||(o[f]=yo(yo({},l),{},{source:u,sourceIndex:s.index}))}}catch(e){c.e(e)}finally{c.f()}return o}(e,t,this._mapping)||{});if(u.length>0){var l=function(e){for(var t,n=e.icons,r=e.buffer,o=e.mapping,i=void 0===o?{}:o,a=e.xOffset,s=void 0===a?0:a,c=e.yOffset,u=void 0===c?0:c,l=e.rowHeight,f=void 0===l?0:l,p=e.canvasWidth,d=[],g=0;g<n.length;g++){var h=n[g];if(!i[xo(h)]){var v=h.height,y=h.width;s+y+r>p&&(wo(i,d,u),s=0,u=f+u+r,f=0,d=[]),d.push({icon:h,xOffset:s}),s=s+y+r,f=Math.max(f,v)}}return d.length>0&&wo(i,d,u),{mapping:i,rowHeight:f,xOffset:s,yOffset:u,canvasWidth:p,canvasHeight:(t=f+u+r,Math.pow(2,Math.ceil(Math.log2(t))))}}({icons:u,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset}),f=l.mapping,p=l.xOffset,d=l.yOffset,g=l.rowHeight,h=l.canvasHeight;this._rowHeight=g,this._mapping=f,this._xOffset=p,this._yOffset=d,this._canvasHeight=h,this._texture||(this._texture=new w.Texture2D(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||bo})),this._texture.height!==this._canvasHeight&&(this._texture=(n=this._texture,r=this._canvasWidth,o=this._canvasHeight,i=this._textureParameters||bo,a=n.width,s=n.height,c=new w.Texture2D(n.gl,{width:r,height:o,parameters:i}),Object(w.copyToTexture)(n,c,{targetY:0,width:a,height:s}),n.delete(),c)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(u)}}}},{key:"_loadIcons",value:function(e){var t,n=this,r=this._canvas.getContext("2d"),o=go(e);try{var i=function(){var e=t.value;n._pendingCount++,function(e,t,n,r){return po.apply(this,arguments)}(e.url,De,n._loadOptions).then((function(t){var o=xo(e),i=n._mapping[o],a=i.x,s=i.y,c=i.width,u=i.height,l=function(e,t,n,r){return n===t.width&&r===t.height?t:(e.canvas.height=r,e.canvas.width=n,e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0,t.width,t.height,0,0,n,r),e.canvas)}(r,t,c,u);n._texture.setSubImageData({data:l,x:a,y:s,width:c,height:u}),n._texture.generateMipmap(),n.onUpdate()})).catch((function(t){n.onError({url:e.url,source:e.source,sourceIndex:e.sourceIndex,loadOptions:n._loadOptions,error:t})})).finally((function(){n._pendingCount--}))};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}}}]),e}();function _o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function So(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Co=[0,0,0,255],ko={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:function(e){return e.position}},getIcon:{type:"accessor",value:function(e){return e.icon}},getColor:{type:"accessor",value:Co},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}},Lo=function(e){d()(n,e);var t=So(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.picking]})}},{key:"initializeState",value:function(){this.state={iconManager:new Po(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Co},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(e){f()(y()(n.prototype),"updateState",this).call(this,e);var t=e.props,r=e.oldProps,o=e.changeFlags,i=this.getAttributeManager(),a=t.iconAtlas,s=t.iconMapping,c=t.data,u=t.getIcon,l=t.textureParameters,p=this.state.iconManager,d=a||this.internalState.isAsyncPropLoading("iconAtlas");if(p.setProps({loadOptions:t.loadOptions,autoPacking:!d,iconAtlas:a,iconMapping:d?s:null,textureParameters:l}),d?r.iconMapping!==t.iconMapping&&i.invalidate("getIcon"):(o.dataChanged||o.updateTriggersChanged&&(o.updateTriggersChanged.all||o.updateTriggersChanged.getIcon))&&p.packIcons(c,u),o.extensionsChanged){var g,h=this.context.gl;null===(g=this.state.model)||void 0===g||g.delete(),this.state.model=this._getModel(h),i.invalidateAll()}}},{key:"isLoaded",get:function(){return f()(y()(n.prototype),"isLoaded",this)&&this.state.iconManager.isLoaded}},{key:"finalizeState",value:function(e){f()(y()(n.prototype),"finalizeState",this).call(this,e),this.state.iconManager.finalize()}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.sizeScale,o=n.sizeMinPixels,i=n.sizeMaxPixels,a=n.sizeUnits,s=n.billboard,c=n.alphaCutoff,u=this.state.iconManager.getTexture();u&&this.state.model.setUniforms(t).setUniforms({iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:x.UNIT[a],sizeScale:r,sizeMinPixels:o,sizeMaxPixels:i,billboard:s,alphaCutoff:c}).draw()}},{key:"_getModel",value:function(e){return new w.Model(e,Oo(Oo({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"_onError",value:function(e){var t,n=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;n?n(e):x.log.error(e.error.message)()}},{key:"getInstanceOffset",value:function(e){var t=this.state.iconManager.getIconMapping(e),n=t.width,r=t.height,o=t.anchorX,i=void 0===o?n/2:o,a=t.anchorY;return[n/2-i,r/2-(void 0===a?r/2:a)]}},{key:"getInstanceColorMode",value:function(e){return this.state.iconManager.getIconMapping(e).mask?1:0}},{key:"getInstanceIconFrame",value:function(e){var t=this.state.iconManager.getIconMapping(e);return[t.x,t.y,t.width,t.height]}}]),n}(x.Layer);b()(Lo,"defaultProps",ko),b()(Lo,"layerName","IconLayer");function jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jo(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Eo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Io={getSourcePosition:{type:"accessor",value:function(e){return e.sourcePosition}},getTargetPosition:{type:"accessor",value:function(e){return e.targetPosition}},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},Mo=function(e){d()(n,e);var t=Eo(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      // Line is not split, abort\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n\n  // Position\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  \n  // linear interpolation of source & target to pick right coord\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  // Multiply out width and clamp to limits\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n\n  // extrude\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.picking]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}},{key:"updateState",value:function(e){if(f()(y()(n.prototype),"updateState",this).call(this,e),e.changeFlags.extensionsChanged){var t,r=this.context.gl;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.widthUnits,o=n.widthScale,i=n.widthMinPixels,a=n.widthMaxPixels,s=n.wrapLongitude;this.state.model.setUniforms(t).setUniforms({widthUnits:x.UNIT[r],widthScale:o,widthMinPixels:i,widthMaxPixels:a,useShortestPath:s?1:0}).draw(),s&&this.state.model.setUniforms({useShortestPath:-1}).draw()}},{key:"_getModel",value:function(e){return new w.Model(e,Ao(Ao({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0}))}}]),n}(x.Layer);b()(Mo,"layerName","LineLayer"),b()(Mo,"defaultProps",Io);function To(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ro(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?To(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):To(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Fo=[0,0,0,255],Do=[0,0,1],Uo={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:function(e){return e.position}},getNormal:{type:"accessor",value:Do},getColor:{type:"accessor",value:Fo},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};var Bo=function(e){d()(n,e);var t=zo(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  // Find the center of the point and add the current vertex\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply lighting\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n\n  // Apply opacity to instance color, or return instance picking color\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.gouraudLighting,x.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:Do},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Fo}})}},{key:"updateState",value:function(e){var t,r,o,i=e.changeFlags,a=e.props;if(f()(y()(n.prototype),"updateState",this).call(this,e),i.extensionsChanged){var s,c=this.context.gl;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(c),this.getAttributeManager().invalidateAll()}i.dataChanged&&(t=a.data,r=t.header,o=t.attributes,r&&o&&(t.length=r.vertexCount,o.POSITION&&(o.instancePositions=o.POSITION),o.NORMAL&&(o.instanceNormals=o.NORMAL),o.COLOR_0&&(o.instanceColors=o.COLOR_0)))}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.pointSize,o=n.sizeUnits;this.state.model.setUniforms(t).setUniforms({sizeUnits:x.UNIT[o],radiusPixels:r}).draw()}},{key:"_getModel",value:function(e){for(var t=[],n=0;n<3;n++){var r=n/3*Math.PI*2;t.push(2*Math.cos(r),2*Math.sin(r),0)}return new w.Model(e,Ro(Ro({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:4,attributes:{positions:new Float32Array(t)}}),isInstanced:!0}))}}]),n}(x.Layer);b()(Bo,"layerName","PointCloudLayer"),b()(Bo,"defaultProps",Uo);function Wo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function No(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wo(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Go(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Vo=[0,0,0,255],Ho={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Vo},getLineColor:{type:"accessor",value:Vo},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Zo=function(e){d()(n,e);var t=Go(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  \n  // Multiply out line width and clamp to limits\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n\n  // Expand geometry to accomodate edge smoothing\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(e){if(f()(y()(n.prototype),"updateState",this).call(this,e),e.changeFlags.extensionsChanged){var t,r=this.context.gl;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.radiusUnits,o=n.radiusScale,i=n.radiusMinPixels,a=n.radiusMaxPixels,s=n.stroked,c=n.filled,u=n.billboard,l=n.antialiasing,f=n.lineWidthUnits,p=n.lineWidthScale,d=n.lineWidthMinPixels,g=n.lineWidthMaxPixels;this.state.model.setUniforms(t).setUniforms({stroked:s?1:0,filled:c,billboard:u,antialiasing:l,radiusUnits:x.UNIT[r],radiusScale:o,radiusMinPixels:i,radiusMaxPixels:a,lineWidthUnits:x.UNIT[f],lineWidthScale:p,lineWidthMinPixels:d,lineWidthMaxPixels:g}).draw()}},{key:"_getModel",value:function(e){return new w.Model(e,No(No({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0}))}}]),n}(x.Layer);b()(Zo,"defaultProps",Ho),b()(Zo,"layerName","ScatterplotLayer");var Ko=1,Jo=-1;function Yo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Xo(e,n);return r!==t&&(qo(e,n),!0)}function Xo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign($o(e,t))}function $o(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.start,r=void 0===n?0:n,o=t.end,i=void 0===o?e.length:o,a=t.size||2,s=0,c=r,u=i-a;c<i;c+=a)s+=(e[c]-e[u])*(e[c+1]+e[u+1]),u=c;return s/2}function qo(e,t){for(var n=t.start,r=void 0===n?0:n,o=t.end,i=void 0===o?e.length:o,a=t.size,s=void 0===a?2:a,c=(i-r)/s,u=Math.floor(c/2),l=0;l<u;++l)for(var f=r+l*s,p=r+(c-1-l)*s,d=0;d<s;++d){var g=e[f+d];e[f+d]=e[p+d],e[p+d]=g}}function Qo(e,t){var n=t.length,r=e.length;if(r>0){for(var o=!0,i=0;i<n;i++)if(e[r-n+i]!==t[i]){o=!1;break}if(o)return!1}for(var a=0;a<n;a++)e[r+a]=t[a];return!0}function ei(e,t){for(var n=t.length,r=0;r<n;r++)e[r]=t[r]}function ti(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=r+t*n,a=0;a<n;a++)o[a]=e[i+a];return o}function ni(e,t,n,r){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)o=(r[3]-e[1])/(t[1]-e[1]),i=3;else if(4&n)o=(r[1]-e[1])/(t[1]-e[1]),i=1;else if(2&n)o=(r[2]-e[0])/(t[0]-e[0]),i=2;else{if(!(1&n))return null;o=(r[0]-e[0])/(t[0]-e[0]),i=0}for(var s=0;s<e.length;s++)a[s]=(1&i)===s?r[i]:o*(t[s]-e[s])+e[s];return a}function ri(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function oi(e,t){var n,r,o=t||{},i=o.size,a=void 0===i?2:i,s=o.broken,c=void 0!==s&&s,u=o.gridResolution,l=void 0===u?10:u,f=o.gridOffset,p=void 0===f?[0,0]:f,d=o.startIndex,g=void 0===d?0:d,h=o.endIndex,v=((void 0===h?e.length:h)-g)/a,y=[],m=[y],b=ti(e,0,a,g),x=ci(b,l,p,[]),w=[];Qo(y,b);for(var P=1;P<v;P++){for(r=ri(n=ti(e,P,a,g,n),x);r;){ni(b,n,r,x,w);var _=ri(w,x);_&&(ni(b,w,_,x,w),r=_),Qo(y,w),ei(b,w),ui(x,l,r),c&&y.length>a&&(y=[],m.push(y),Qo(y,b)),r=ri(n,x)}Qo(y,n),ei(b,n)}return c?m:m[0]}function ii(e,t){for(var n=0;n<t.length;n++)e.push(t[n]);return e}function ai(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!e.length)return[];for(var r=n||{},o=r.size,i=void 0===o?2:o,a=r.gridResolution,s=void 0===a?10:a,c=r.gridOffset,u=void 0===c?[0,0]:c,l=r.edgeTypes,f=void 0!==l&&l,p=[],d=[{pos:e,types:f?new Array(e.length/i).fill(1):null,holes:t||[]}],g=[[],[]],h=[];d.length;){var v=d.shift(),y=v.pos,m=v.types,b=v.holes;li(y,i,b[0]||y.length,g),h=ci(g[0],s,u,h);var x=ri(g[1],h);if(x){var w=si(y,m,i,0,b[0]||y.length,h,x),P={pos:w[0].pos,types:w[0].types,holes:[]},_={pos:w[1].pos,types:w[1].types,holes:[]};d.push(P,_);for(var O=0;O<b.length;O++)(w=si(y,m,i,b[O],b[O+1]||y.length,h,x))[0]&&(P.holes.push(P.pos.length),P.pos=ii(P.pos,w[0].pos),f&&(P.types=ii(P.types,w[0].types))),w[1]&&(_.holes.push(_.pos.length),_.pos=ii(_.pos,w[1].pos),f&&(_.types=ii(_.types,w[1].types)))}else{var S={positions:y};f&&(S.edgeTypes=m),b.length&&(S.holeIndices=b),p.push(S)}}return p}function si(e,t,n,r,o,i,a){for(var s,c,u,l=(o-r)/n,f=[],p=[],d=[],g=[],h=[],v=ti(e,l-1,n,r),y=Math.sign(8&a?v[1]-i[3]:v[0]-i[2]),m=t&&t[l-1],b=0,x=0,w=0;w<l;w++)s=ti(e,w,n,r,s),c=Math.sign(8&a?s[1]-i[3]:s[0]-i[2]),u=t&&t[r/n+w],c&&y&&y!==c&&(ni(v,s,a,i,h),Qo(f,h)&&d.push(m),Qo(p,h)&&g.push(m)),c<=0?(Qo(f,s)&&d.push(u),b-=c):d.length&&(d[d.length-1]=0),c>=0?(Qo(p,s)&&g.push(u),x+=c):g.length&&(g[g.length-1]=0),ei(v,s),y=c,m=u;return[b?{pos:f,types:t&&d}:null,x?{pos:p,types:t&&g}:null]}function ci(e,t,n,r){var o=Math.floor((e[0]-n[0])/t)*t+n[0],i=Math.floor((e[1]-n[1])/t)*t+n[1];return r[0]=o,r[1]=i,r[2]=o+t,r[3]=i+t,r}function ui(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function li(e,t,n,r){for(var o=1/0,i=-1/0,a=1/0,s=-1/0,c=0;c<n;c+=t){var u=e[c],l=e[c+1];o=u<o?u:o,i=u>i?u:i,a=l<a?l:a,s=l>s?l:s}return r[0][0]=o,r[0][1]=a,r[1][0]=i,r[1][1]=s,r}function fi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function di(e,t,n,r){for(var o=-1,i=-1,a=n+1;a<r;a+=t){var s=Math.abs(e[a]);s>o&&(o=s,i=a-1)}return i}function gi(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129,i=e[n],a=e[r-t];if(Math.abs(i-a)>180){var s=ti(e,0,t,n);s[0]+=360*Math.round((a-i)/360),Qo(e,s),s[1]=Math.sign(s[1])*o,Qo(e,s),s[0]=i,Qo(e,s)}}function hi(e,t,n,r){for(var o,i=e[0],a=n;a<r;a+=t){var s=(o=e[a])-i;(s>180||s<-180)&&(o-=360*Math.round(s/360)),e[a]=i=o}}function vi(e,t){for(var n,r=e.length/t,o=0;o<r&&((n=e[o*t])+180)%360==0;o++);var i=360*-Math.round(n/360);if(0!==i)for(var a=0;a<r;a++)e[a*t]+=i}function yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var xi=function(e){d()(n,e);var t=bi(n);function n(e){i()(this,n);var r=e.id,o=void 0===r?Object(w.uid)("column-geometry"):r,a=function(e){var t=e.radius,n=e.height,r=void 0===n?1:n,o=e.nradial,i=void 0===o?10:o,a=e.vertices;a&&(x.log.assert(a.length>=i),Yo(a=a.flatMap((function(e){return[e[0],e[1]]})),Jo));var s=r>0,c=i+1,u=s?3*c+1:i,l=2*Math.PI/i,f=new Uint16Array(s?3*i*2:0),p=new Float32Array(3*u),d=new Float32Array(3*u),g=0;if(s){for(var h=0;h<c;h++)for(var v=h*l,y=h%i,m=Math.sin(v),b=Math.cos(v),w=0;w<2;w++)p[g+0]=a?a[2*y]:b*t,p[g+1]=a?a[2*y+1]:m*t,p[g+2]=(.5-w)*r,d[g+0]=a?a[2*y]:b,d[g+1]=a?a[2*y+1]:m,g+=3;p[g+0]=p[g-3],p[g+1]=p[g-2],p[g+2]=p[g-1],g+=3}for(var P=s?0:1;P<c;P++){var _=Math.floor(P/2)*Math.sign(.5-P%2),O=_*l,S=(_+i)%i,C=Math.sin(O),k=Math.cos(O);p[g+0]=a?a[2*S]:k*t,p[g+1]=a?a[2*S+1]:C*t,p[g+2]=r/2,d[g+2]=1,g+=3}if(s)for(var L=0,j=0;j<i;j++)f[L++]=2*j+0,f[L++]=2*j+2,f[L++]=2*j+0,f[L++]=2*j+1,f[L++]=2*j+1,f[L++]=2*j+3;return{indices:f,attributes:{POSITION:{size:3,value:p},NORMAL:{size:3,value:d}}}}(e),s=a.indices,c=a.attributes;return t.call(this,mi(mi({},e),{},{id:o,indices:s,attributes:c}))}return n}(w.Geometry);function wi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wi(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Oi=[0,0,0,255],Si={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:function(e){return e.position}},getFillColor:{type:"accessor",value:Oi},getLineColor:{type:"accessor",value:Oi},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Ci=function(e){d()(n,e);var t=_i(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getShaders",value:function(){var e=this.context.gl,t=!Object(w.isWebGL2)(e),r={},o=this.props.flatShading&&Object(w.hasFeature)(e,w.FEATURES.GLSL_DERIVATIVES);return o&&(r.FLAT_SHADING=1),f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n\n#define SHADER_NAME column-layer-vertex-shader\n\nin vec3 positions;\nin vec3 normals;\n\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\n\nin vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\n\n// Result\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  // rotate primitive position and normal\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n\n  // calculate elevation, if 3d not enabled set to 0\n  // cylindar gemoetry height are between -1.0 to 1.0, transform it to between 0, 1\n  float elevation = 0.0;\n  // calculate stroke offset\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (stroked) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n    if (isStroke) {\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\n    } else {\n      strokeOffsetRatio -= halfOffset;\n    }\n  }\n\n  // if alpha == 0.0 or z < 0.0, do not render element\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.pickingColor = instancePickingColors;\n\n  // project center of column\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Light calculations\n  if (extruded && !isStroke) {\n#ifdef FLAT_SHADING\n    position_commonspace = geometry.position;\n    vColor = vec4(color.rgb, color.a * opacity);\n#else\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n#endif\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\n\nout vec4 fragColor;\n\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  fragColor = vColor;\n#ifdef FLAT_SHADING\n  if (extruded && !isStroke && !picking_uActive) {\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n  }\n#endif\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:r,transpileToGLSL100:t,modules:[x.project32,o?x.phongLighting:x.gouraudLighting,x.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:Oi},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:Oi},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}},{key:"updateState",value:function(e){f()(y()(n.prototype),"updateState",this).call(this,e);var t=e.props,r=e.oldProps,o=e.changeFlags.extensionsChanged||t.flatShading!==r.flatShading;if(o){var i,a=this.context.gl;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(o||t.diskResolution!==r.diskResolution||t.vertices!==r.vertices||(t.extruded||t.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(t)}},{key:"getGeometry",value:function(e,t,n){var r=new xi({radius:1,height:n?2:0,vertices:t,nradial:e}),o=0;if(t)for(var i=0;i<e;i++){var a=t[i];o+=Math.sqrt(a[0]*a[0]+a[1]*a[1])/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),r}},{key:"_getModel",value:function(e){return new w.Model(e,Pi(Pi({},this.getShaders()),{},{id:this.props.id,isInstanced:!0}))}},{key:"_updateGeometry",value:function(e){var t=e.diskResolution,n=e.vertices,r=e.extruded,o=e.stroked,i=this.getGeometry(t,n,r||o);this.setState({fillVertexCount:i.attributes.POSITION.value.length/3,wireframeVertexCount:i.indices.value.length}),this.state.model.setProps({geometry:i})}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.lineWidthUnits,o=n.lineWidthScale,i=n.lineWidthMinPixels,a=n.lineWidthMaxPixels,s=n.radiusUnits,c=n.elevationScale,u=n.extruded,l=n.filled,f=n.stroked,p=n.wireframe,d=n.offset,g=n.coverage,h=n.radius,v=n.angle,y=this.state,m=y.model,b=y.fillVertexCount,w=y.wireframeVertexCount,P=y.edgeDistance;m.setUniforms(t).setUniforms({radius:h,angle:v/180*Math.PI,offset:d,extruded:u,stroked:f,coverage:g,elevationScale:c,edgeDistance:P,radiusUnits:x.UNIT[s],widthUnits:x.UNIT[r],widthScale:o,widthMinPixels:i,widthMaxPixels:a}),u&&p&&(m.setProps({isIndexed:!0}),m.setVertexCount(w).setDrawMode(1).setUniforms({isStroke:!0}).draw()),l&&(m.setProps({isIndexed:!1}),m.setVertexCount(b).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!u&&f&&(m.setProps({isIndexed:!1}),m.setVertexCount(2*b/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}]),n}(x.Layer);function ki(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}b()(Ci,"layerName","ColumnLayer"),b()(Ci,"defaultProps",Si);var Li=function(e){d()(n,e);var t=ki(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getGeometry",value:function(e){return new w.CubeGeometry}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.elevationScale,o=n.extruded,i=n.offset,a=n.coverage,s=n.cellSize,c=n.angle,u=n.radiusUnits;this.state.model.setUniforms(t).setUniforms({radius:s/2,radiusUnits:x.UNIT[u],angle:c,offset:i,extruded:o,coverage:a,elevationScale:r,edgeDistance:1,isWireframe:!1}).draw()}}]),n}(Ci);function ji(e,t,n,r){var o;if(Array.isArray(e[0])){var i=e.length*t;o=new Array(i);for(var a=0;a<e.length;a++)for(var s=0;s<t;s++)o[a*t+s]=e[a][s]||0}else o=e;return n?oi(o,{size:t,gridResolution:n}):r?function(e,t){var n=t||{},r=n.size,o=void 0===r?2:r,i=n.startIndex,a=void 0===i?0:i,s=n.endIndex,c=void 0===s?e.length:s,u=n.normalize,l=void 0===u||u,f=e.slice(a,c);hi(f,o,0,c-a);var p=oi(f,{size:o,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(l){var d,g=fi(p);try{for(g.s();!(d=g.n()).done;){vi(d.value,o)}}catch(e){g.e(e)}finally{g.f()}}return p}(o,{size:t}):o}function Ai(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ti(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}b()(Li,"layerName","GridCellLayer"),b()(Li,"defaultProps",{cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}});var Ri=function(e){d()(n,e);var t=Ti(n);function n(e){return i()(this,n),t.call(this,Mi(Mi({},e),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}return s()(n,[{key:"get",value:function(e){return this.attributes[e]}},{key:"getGeometryFromBuffer",value:function(e){return this.normalize?f()(y()(n.prototype),"getGeometryFromBuffer",this).call(this,e):null}},{key:"normalizeGeometry",value:function(e){return this.normalize?ji(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}},{key:"getGeometrySize",value:function(e){if(zi(e)){var t,n=0,r=Ai(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n+=this.getGeometrySize(o)}}catch(e){r.e(e)}finally{r.f()}return n}var i=this.getPathLength(e);return i<2?0:this.isClosed(e)?i<3?0:i+2:i}},{key:"updateGeometryAttributes",value:function(e,t){if(0!==t.geometrySize)if(e&&zi(e)){var n,r=Ai(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=this.getGeometrySize(o);t.geometrySize=i,this.updateGeometryAttributes(o,t),t.vertexStart+=i}}catch(e){r.e(e)}finally{r.f()}}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}},{key:"_updateSegmentTypes",value:function(e,t){var n=this.attributes.segmentTypes,r=!!e&&this.isClosed(e),o=t.vertexStart,i=t.geometrySize;n.fill(0,o,o+i),r?(n[o]=4,n[o+i-2]=4):(n[o]+=1,n[o+i-2]+=2),n[o+i-1]=4}},{key:"_updatePositions",value:function(e,t){var n=this.attributes.positions;if(n&&e)for(var r=t.vertexStart,o=t.geometrySize,i=new Array(3),a=r,s=0;s<o;a++,s++)this.getPointOnPath(e,s,i),n[3*a]=i[0],n[3*a+1]=i[1],n[3*a+2]=i[2]}},{key:"getPathLength",value:function(e){return e.length/this.positionSize}},{key:"getPointOnPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.positionSize;t*r>=e.length&&(t+=1-e.length/r);var o=t*r;return n[0]=e[o],n[1]=e[o+1],n[2]=3===r&&e[o+2]||0,n}},{key:"isClosed",value:function(e){if(!this.normalize)return Boolean(this.opts.loop);var t=this.positionSize,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}]),n}(x.Tesselator);function zi(e){return Array.isArray(e[0])}function Fi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Di(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fi(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ui(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Bi=[0,0,0,255],Wi={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:function(e){return e.path}},getColor:{type:"accessor",value:Bi},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Ni={enter:function(e,t){return t.length?t.subarray(t.length-e.length):e}},Gi=function(e){d()(n,e);var t=Ui(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  // side of the segment - -1: left, 0: center, 1: right\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // direction of the segment\n  vec2 dir = isEnd ? dirA : dirB;\n  // direction of the extrusion\n  vec2 perp = isEnd ? perpA : perpB;\n  // length of the segment\n  float L = isEnd ? lenA : lenB;\n\n  // A = angle of the corner\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  // -1: right, 1: left\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  // trim if inside corner extends further than the line segment\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n\n  // special treatment for start cap and end cap\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n\n  // Generate variables for fragment shader\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\n\n// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    // Extrude in clipspace\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    // Extrude in commonspace\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\n/*\n * vPathPosition represents the relative coordinates of the current fragment on the path segment.\n * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.\n * vPathPosition.y - position along the length of the path, between [0, L / width].\n */\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    // if joint is rounded, test distance from the corner\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    // trim miter\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.picking]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){var e=this;this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Ni,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Ni,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Ni,defaultValue:Bi},instancePickingColors:{size:3,type:5121,accessor:function(t,n){var r=n.index,o=n.target;return e.encodePickingColor(t&&t.__source?t.__source.index:r,o)}}}),this.setState({pathTesselator:new Ri({fp64:this.use64bitPositions()})})}},{key:"updateState",value:function(e){f()(y()(n.prototype),"updateState",this).call(this,e);var t=e.props,r=e.changeFlags,o=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){var i=this.state.pathTesselator,a=t.data.attributes||{};i.updateGeometry({data:t.data,geometryBuffer:a.getPath,buffers:a,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:i.instanceCount,startIndices:i.vertexStarts}),r.dataChanged||o.invalidateAll()}if(r.extensionsChanged){var s,c=this.context.gl;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(c),o.invalidateAll()}}},{key:"getPickingInfo",value:function(e){var t=f()(y()(n.prototype),"getPickingInfo",this).call(this,e),r=t.index,o=this.props.data;return o[0]&&o[0].__source&&(t.object=o.find((function(e){return e.__source.index===r}))),t}},{key:"disablePickingIndex",value:function(e){var t=this.props.data;if(t[0]&&t[0].__source)for(var n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else this._disablePickingIndex(e)}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.jointRounded,o=n.capRounded,i=n.billboard,a=n.miterLimit,s=n.widthUnits,c=n.widthScale,u=n.widthMinPixels,l=n.widthMaxPixels;this.state.model.setUniforms(t).setUniforms({jointType:Number(r),capType:Number(o),billboard:i,widthUnits:x.UNIT[s],widthScale:c,miterLimit:a,widthMinPixels:u,widthMaxPixels:l}).draw()}},{key:"_getModel",value:function(e){return new w.Model(e,Di(Di({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}},{key:"calculatePositions",value:function(e){var t=this.state.pathTesselator;e.startIndices=t.vertexStarts,e.value=t.get("positions")}},{key:"calculateSegmentTypes",value:function(e){var t=this.state.pathTesselator;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}]),n}(x.Layer);b()(Gi,"defaultProps",Wi),b()(Gi,"layerName","PathLayer");var Vi=n(39),Hi=n.n(Vi);function Zi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ki(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ki(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ji=Ko,Yi=Jo,Xi={isClosed:!0};function $i(e){return"positions"in e?e.positions:e}function qi(e){return"holeIndices"in e?e.holeIndices:null}function Qi(e,t,n,r){for(var o=0;o<t;o++)if(e[n+o]!==e[r-t+o])return!1;return!0}function ea(e,t,n,r,o){for(var i=t,a=n.length,s=0;s<a;s++)for(var c=0;c<r;c++)e[i++]=n[s][c]||0;if(!function(e){var t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(var u=0;u<r;u++)e[i++]=n[0][u]||0;return Xi.start=t,Xi.end=i,Xi.size=r,Yo(e,o,Xi),i}function ta(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=(i=i||n.length)-o;if(s<=0)return t;for(var c=t,u=0;u<s;u++)e[c++]=n[o+u];if(!Qi(n,r,o,i))for(var l=0;l<r;l++)e[c++]=n[o+l];return Xi.start=t,Xi.end=c,Xi.size=r,Yo(e,a,Xi),c}function na(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);var n=[],r=[];if("positions"in e){var o=e,i=o.positions,a=o.holeIndices;if(a){for(var s=0,c=0;c<=a.length;c++)s=ta(n,s,i,t,a[c-1],a[c],0===c?Ji:Yi),r.push(s);return r.pop(),{positions:n,holeIndices:r}}e=i}if(!function(e){return Array.isArray(e[0])}(e))return ta(n,0,e,t,0,n.length,Ji),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){var u,l=0,f=Zi(e.entries());try{for(f.s();!(u=f.n()).done;){var p=j()(u.value,2),d=p[0];l=ea(n,l,p[1],t,0===d?Ji:Yi),r.push(l)}}catch(e){f.e(e)}finally{f.f()}return r.pop(),{positions:n,holeIndices:r}}return ea(n,0,e,t,Ji),n}function ra(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return oa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function oa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ia(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var ca=function(e){d()(n,e);var t=sa(n);function n(e){i()(this,n);var r=e.fp64,o=e.IndexType,a=void 0===o?Uint32Array:o;return t.call(this,aa(aa({},e),{},{attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:a,size:1}}}))}return s()(n,[{key:"get",value:function(e){var t=this.attributes;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}},{key:"updateGeometry",value:function(e){f()(y()(n.prototype),"updateGeometry",this).call(this,e);var t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}},{key:"normalizeGeometry",value:function(e){if(this.normalize){var t=na(e,this.positionSize);return this.opts.resolution?ai($i(t),qi(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=n||{},o=r.size,i=void 0===o?2:o,a=r.normalize,s=void 0===a||a,c=r.edgeTypes,u=void 0!==c&&c;t=t||[];for(var l=[],f=[],p=0,d=0,g=0;g<=t.length;g++){for(var h=t[g]||e.length,v=d,y=di(e,i,p,h),m=y;m<h;m++)l[d++]=e[m];for(var b=p;b<y;b++)l[d++]=e[b];hi(l,i,v,d),gi(l,i,v,d,null==n?void 0:n.maxLatitude),p=h,f[g]=d}f.pop();var x=ai(l,f,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:u});if(s){var w,P=fi(x);try{for(P.s();!(w=P.n()).done;){var _=w.value;vi(_.positions,i)}}catch(e){P.e(e)}finally{P.f()}}return x}($i(t),qi(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}},{key:"getGeometrySize",value:function(e){if(ua(e)){var t,n=0,r=ra(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n+=this.getGeometrySize(o)}}catch(e){r.e(e)}finally{r.f()}return n}return $i(e).length/this.positionSize}},{key:"getGeometryFromBuffer",value:function(e){return this.normalize||!this.buffers.indices?f()(y()(n.prototype),"getGeometryFromBuffer",this).call(this,e):null}},{key:"updateGeometryAttributes",value:function(e,t){if(e&&ua(e)){var n,r=ra(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=this.getGeometrySize(o);t.geometrySize=i,this.updateGeometryAttributes(o,t),t.vertexStart+=i,t.indexStart=this.indexStarts[t.geometryIndex+1]}}catch(e){r.e(e)}finally{r.f()}}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}},{key:"_updateIndices",value:function(e,t){var n=t.geometryIndex,r=t.vertexStart,o=t.indexStart,i=this.attributes,a=this.indexStarts,s=this.typedArrayManager,c=i.indices;if(c&&e){var u=o,l=function(e,t,n){var r=qi(e);r&&(r=r.map((function(e){return e/t})));var o=$i(e);if(n){var i=o.length;o=o.slice();for(var a=[],s=0;s<i;s+=t){a[0]=o[s],a[1]=o[s+1];var c=n(a);o[s]=c[0],o[s+1]=c[1]}}return Hi()(o,r,t)}(e,this.positionSize,this.opts.preproject);c=s.allocate(c,o+l.length,{copy:!0});for(var f=0;f<l.length;f++)c[u++]=l[f]+r;a[n+1]=o+l.length,i.indices=c}}},{key:"_updatePositions",value:function(e,t){var n=t.vertexStart,r=t.geometrySize,o=this.attributes.positions,i=this.positionSize;if(o&&e)for(var a=$i(e),s=n,c=0;c<r;s++,c++){var u=a[c*i],l=a[c*i+1],f=i>2?a[c*i+2]:0;o[3*s]=u,o[3*s+1]=l,o[3*s+2]=f}}},{key:"_updateVertexValid",value:function(e,t){var n=t.vertexStart,r=t.geometrySize,o=this.positionSize,i=this.attributes.vertexValid,a=e&&qi(e);if(e&&e.edgeTypes?i.set(e.edgeTypes,n):i.fill(1,n,n+r),a)for(var s=0;s<a.length;s++)i[n+a[s]/o-1]=0;i[n+r-1]=0}}]),n}(x.Tesselator);function ua(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}var la="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fa="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(la,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),pa="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(la,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");function da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ga(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?da(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var va=[0,0,0,255],ya={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(e){return e.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:va},getLineColor:{type:"accessor",value:va},material:!0},ma={enter:function(e,t){return t.length?t.subarray(t.length-e.length):e}},ba=function(e){d()(n,e);var t=ha(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(e){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"top"===e?fa:pa,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[x.project32,x.gouraudLighting,x.picking]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){var e=this,t=this.context,n=t.gl,r=t.viewport,o=this.props.coordinateSystem;r.isGeospatial&&o===x.COORDINATE_SYSTEM.DEFAULT&&(o=x.COORDINATE_SYSTEM.LNGLAT),this.setState({numInstances:0,polygonTesselator:new ca({preproject:o===x.COORDINATE_SYSTEM.LNGLAT&&r.projectFlat.bind(r),fp64:this.use64bitPositions(),IndexType:!n||Object(w.hasFeatures)(n,w.FEATURES.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var i=this.getAttributeManager();i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:ma,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:ma,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ma,accessor:"getFillColor",defaultValue:va,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ma,accessor:"getLineColor",defaultValue:va,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:function(t,n){var r=n.index,o=n.target;return e.encodePickingColor(t&&t.__source?t.__source.index:r,o)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}},{key:"getPickingInfo",value:function(e){var t=f()(y()(n.prototype),"getPickingInfo",this).call(this,e),r=t.index,o=this.props.data;return o[0]&&o[0].__source&&(t.object=o.find((function(e){return e.__source.index===r}))),t}},{key:"disablePickingIndex",value:function(e){var t=this.props.data;if(t[0]&&t[0].__source)for(var n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else this._disablePickingIndex(e)}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.extruded,o=n.filled,i=n.wireframe,a=n.elevationScale,s=this.state,c=s.topModel,u=s.sideModel,l=s.polygonTesselator,f=ga(ga({},t),{},{extruded:Boolean(r),elevationScale:a});u&&(u.setInstanceCount(l.instanceCount-1),u.setUniforms(f),i&&(u.setDrawMode(3),u.setUniforms({isWireframe:!0}).draw()),o&&(u.setDrawMode(6),u.setUniforms({isWireframe:!1}).draw())),c&&(c.setVertexCount(l.vertexCount),c.setUniforms(f).draw())}},{key:"updateState",value:function(e){f()(y()(n.prototype),"updateState",this).call(this,e),this.updateGeometry(e);var t,r=e.props,o=e.oldProps,i=e.changeFlags,a=this.getAttributeManager();(i.extensionsChanged||r.filled!==o.filled||r.extruded!==o.extruded)&&(null===(t=this.state.models)||void 0===t||t.forEach((function(e){return e.delete()})),this.setState(this._getModels(this.context.gl)),a.invalidateAll())}},{key:"updateGeometry",value:function(e){var t=e.props,n=(e.oldProps,e.changeFlags);if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var r=this.state.polygonTesselator,o=t.data.attributes||{};r.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:r.instanceCount,startIndices:r.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}},{key:"_getModels",value:function(e){var t,n,r=this.props,o=r.id,i=r.filled,a=r.extruded;if(i){var s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,t=new w.Model(e,ga(ga({},s),{},{id:"".concat(o,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0}))}return a&&((n=new w.Model(e,ga(ga({},this.getShaders("side")),{},{id:"".concat(o,"-side"),geometry:new w.Geometry({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}))).userData.excludeAttributes={indices:!0}),{models:[n,t].filter(Boolean),topModel:t,sideModel:n}}},{key:"calculateIndices",value:function(e){var t=this.state.polygonTesselator;e.startIndices=t.indexStarts,e.value=t.get("indices")}},{key:"calculatePositions",value:function(e){var t=this.state.polygonTesselator;e.startIndices=t.vertexStarts,e.value=t.get("positions")}},{key:"calculateVertexValid",value:function(e){e.value=this.state.polygonTesselator.get("vertexValid")}}]),n}(x.Layer);function xa(e){for(var t=e.data,n=e.getIndex,r=e.dataRange,o=e.replace,i=r.startRow,a=void 0===i?0:i,s=r.endRow,c=void 0===s?1/0:s,u=t.length,l=u,f=u,p=0;p<u;p++){var d=n(t[p]);if(l>p&&d>=a&&(l=p),d>=c){f=p;break}}for(var g=l,h=f-l!==o.length?t.slice(f):void 0,v=0;v<o.length;v++)t[g++]=o[v];if(h){for(var y=0;y<h.length;y++)t[g++]=h[y];t.length=g}return{startRow:l,endRow:l+o.length}}function wa(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}b()(ba,"defaultProps",ya),b()(ba,"layerName","SolidPolygonLayer");var Oa=[0,0,0,255],Sa={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:function(e){return e.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:Oa},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},Ca=function(e){d()(n,e);var t=_a(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"initializeState",value:function(){this.state={paths:[]},this.props.getLineDashArray&&x.log.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var t=this,n=e.changeFlags,r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r&&Array.isArray(n.dataChanged)){var o=this.state.paths.slice(),i=n.dataChanged.map((function(e){return xa({data:o,getIndex:function(e){return e.__source.index},dataRange:e,replace:t._getPaths(e)})}));this.setState({paths:o,pathsDiff:i})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props,r=n.data,o=n.getPolygon,i=n.positionFormat,a=n._normalize,s=[],c="XY"===i?2:3,u=t.startRow,l=t.endRow,f=Object(x.createIterable)(r,u,l),p=f.iterable,d=f.objectInfo,g=wa(p);try{for(g.s();!(e=g.n()).done;){var h=e.value;d.index++;var v=o(h,d);a&&(v=na(v,c));var y=v,m=y.holeIndices,b=v.positions||v;if(m)for(var w=0;w<=m.length;w++){var P=b.slice(m[w-1]||0,m[w]||b.length);s.push(this.getSubLayerRow({path:P},h,d.index))}else s.push(this.getSubLayerRow({path:b},h,d.index))}}catch(e){g.e(e)}finally{g.f()}return s}},{key:"renderLayers",value:function(){var e=this.props,t=e.data,n=e._dataDiff,r=e.stroked,o=e.filled,i=e.extruded,a=e.wireframe,s=e._normalize,c=e._windingOrder,u=e.elevationScale,l=e.transitions,f=e.positionFormat,p=this.props,d=p.lineWidthUnits,g=p.lineWidthScale,h=p.lineWidthMinPixels,v=p.lineWidthMaxPixels,y=p.lineJointRounded,m=p.lineMiterLimit,b=p.lineDashJustified,x=this.props,w=x.getFillColor,P=x.getLineColor,_=x.getLineWidth,O=x.getLineDashArray,S=x.getElevation,C=x.getPolygon,k=x.updateTriggers,L=x.material,j=this.state,A=j.paths,E=j.pathsDiff,I=this.getSubLayerClass("fill",ba),M=this.getSubLayerClass("stroke",Gi),T=this.shouldRenderSubLayer("fill",A)&&new I({_dataDiff:n,extruded:i,elevationScale:u,filled:o,wireframe:a,_normalize:s,_windingOrder:c,getElevation:S,getFillColor:w,getLineColor:i&&a?P:Oa,material:L,transitions:l},this.getSubLayerProps({id:"fill",updateTriggers:k&&{getPolygon:k.getPolygon,getElevation:k.getElevation,getFillColor:k.getFillColor,lineColors:i&&a,getLineColor:k.getLineColor}}),{data:t,positionFormat:f,getPolygon:C});return[!i&&T,!i&&r&&this.shouldRenderSubLayer("stroke",A)&&new M({_dataDiff:E&&function(){return E},widthUnits:d,widthScale:g,widthMinPixels:h,widthMaxPixels:v,jointRounded:y,miterLimit:m,dashJustified:b,_pathType:"loop",transitions:l&&{getWidth:l.getLineWidth,getColor:l.getLineColor,getPath:l.getPolygon},getColor:this.getSubLayerAccessor(P),getWidth:this.getSubLayerAccessor(_),getDashArray:this.getSubLayerAccessor(O)},this.getSubLayerProps({id:"stroke",updateTriggers:k&&{getWidth:k.getLineWidth,getColor:k.getLineColor,getDashArray:k.getLineDashArray}}),{data:A,positionFormat:f,getPath:function(e){return e.path}}),i&&T]}}]),n}(x.CompositeLayer);b()(Ca,"layerName","PolygonLayer"),b()(Ca,"defaultProps",Sa);var ka=n(40),La=n.n(ka);function ja(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ja(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ja(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ea(e,t){if(!e)return null;var n="startIndices"in e?e.startIndices[t]:t,r=e.featureIds.value[n];return-1!==n?function(e,t,n){var r={properties:Aa({},e.properties[t])};for(var o in e.numericProps)r.properties[o]=e.numericProps[o].value[n];return r}(e,r,n):null}function Ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ia(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var Ra=[],za=function(e){d()(n,e);var t=Ta(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(){return Ma(Ma({},f()(y()(n.prototype),"getShaders",this).call(this)),{},{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}},{key:"initializeState",value:function(){var e=this;f()(y()(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:function(t,n){var r=n.index,o=n.target;return e.encodePickingColor(r,o)}}})}},{key:"updateState",value:function(e){f()(y()(n.prototype),"updateState",this).call(this,e);var t=e.props,r=e.oldProps,o=t.outlineColor;o!==r.outlineColor&&((o=o.map((function(e){return e/255})))[3]=Number.isFinite(o[3])?o[3]:1,this.setState({outlineColor:o})),!t.sdf&&t.outlineWidth&&x.log.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}},{key:"draw",value:function(e){var t=this.props,r=t.sdf,o=t.smoothing,i=t.outlineWidth,a=this.state.outlineColor;e.uniforms=Ma(Ma({},e.uniforms),{},{buffer:.75,outlineBuffer:i?Math.max(o,.75*(1-i)):-1,gamma:o,sdf:Boolean(r),outlineColor:a}),f()(y()(n.prototype),"draw",this).call(this,e)}},{key:"getInstanceOffset",value:function(e){var t=this;return e?Array.from(e).flatMap((function(e){return f()(y()(n.prototype),"getInstanceOffset",t).call(t,e)})):Ra}},{key:"getInstanceColorMode",value:function(e){return 1}},{key:"getInstanceIconFrame",value:function(e){var t=this;return e?Array.from(e).flatMap((function(e){return f()(y()(n.prototype),"getInstanceIconFrame",t).call(t,e)})):Ra}}]),n}(Lo);b()(za,"defaultProps",{getIconOffsets:{type:"accessor",value:function(e){return e.offsets}},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),b()(za,"layerName","MultiIconLayer");var Fa=n(41),Da=n.n(Fa);function Ua(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ba(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wa=[];function Na(e,t,n,r){for(var o=0,i=t;i<n;i++){var a;o+=(null===(a=r[e[i]])||void 0===a?void 0:a.width)||0}return o}function Ga(e,t,n,r,o,i){for(var a=t,s=0,c=t;c<n;c++){var u=Na(e,c,c+1,o);s+u>r&&(a<c&&i.push(c),a=c,s=0),s+=u}return s}function Va(e,t,n,r,o,i){for(var a=t,s=t,c=t,u=0,l=t;l<n;l++)if(" "===e[l]?c=l+1:" "!==e[l+1]&&l+1!==n||(c=l+1),c>s){var f=Na(e,s,c,o);u+f>r&&(a<s&&(i.push(s),a=s,u=0),f>r&&(f=Ga(e,s,c,r,o,i),a=i[i.length-1])),s=c,u+=f}return u}function Ha(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0;void 0===i&&(i=e.length);var a=[];return"break-all"===t?Ga(e,o,i,n,r,a):Va(e,o,i,n,r,a),a}function Za(e,t,n,r,o,i){for(var a=0,s=0,c=t;c<n;c++){var u=e[c],l=r[u];l?(s||(s=l.height),o[c]=a+l.width/2,a+=l.width):(x.log.warn("Missing character: ".concat(u," (").concat(u.codePointAt(0),")"))(),o[c]=a,a+=32)}i[0]=a,i[1]=s}function Ka(e,t,n,r,o){for(var i=Array.from(e),a=i.length,s=new Array(a),c=new Array(a),u=new Array(a),l=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,f=[0,0],p=[0,0],d=0,g=0,h=0,v=0;v<=a;v++){var y=i[v];if("\n"!==y&&v!==a||(h=v),h>g){for(var m=l?Ha(i,n,r,o,g,h):Wa,b=0;b<=m.length;b++){var x=0===b?g:m[b-1],w=b<m.length?m[b]:h;Za(i,x,w,o,s,p);for(var P=x;P<w;P++)c[P]=d+p[1]/2,u[P]=p[0];d+=p[1]*t,f[0]=Math.max(f[0],p[0])}g=h}"\n"===y&&(s[g]=0,c[g]=0,u[g]=0,g++)}return f[1]=d,{x:s,y:c,rowWidth:u,size:f}}var Ja=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;i()(this,e),b()(this,"limit",void 0),b()(this,"_cache",{}),b()(this,"_order",[]),this.limit=t}return s()(e,[{key:"get",value:function(e){var t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}},{key:"set",value:function(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}},{key:"delete",value:function(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}},{key:"_deleteOrder",value:function(e){var t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}},{key:"_appendOrder",value:function(e){this._order.push(e)}}]),e}();function Ya(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$a(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qa={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},es=new Ja(3);function ts(e,t){var n;n="string"==typeof t?new Set(Array.from(t)):new Set(t);var r=es.get(e);if(!r)return n;for(var o in r.mapping)n.has(o)&&n.delete(o);return n}function ns(e,t){for(var n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function rs(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}var os=function(){function e(){i()(this,e),b()(this,"props",qa({},Qa)),b()(this,"_key",void 0),b()(this,"_atlas",void 0)}return s()(e,[{key:"texture",get:function(){return this._atlas}},{key:"mapping",get:function(){return this._atlas&&this._atlas.mapping}},{key:"scale",get:function(){return 1.2}},{key:"setProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,e);var t=this._key;this._key=this._getKey();var n=ts(this._key,this.props.characterSet),r=es.get(this._key);if(r&&0===n.size)this._key!==t&&(this._atlas=r);else{var o=this._generateFontAtlas(this._key,n,r);this._atlas=o,es.set(this._key,o)}}},{key:"_generateFontAtlas",value:function(e,t,n){var r=this.props,o=r.fontFamily,i=r.fontWeight,a=r.fontSize,s=r.buffer,c=r.sdf,u=r.radius,l=r.cutoff,f=n&&n.data;f||((f=document.createElement("canvas")).width=1024);var p=f.getContext("2d");rs(p,o,a,i);var d=function(e){var t,n=e.characterSet,r=e.getFontWidth,o=e.fontHeight,i=e.buffer,a=e.maxCanvasWidth,s=e.mapping,c=void 0===s?{}:s,u=e.xOffset,l=void 0===u?0:u,f=e.yOffset,p=void 0===f?0:f,d=0,g=l,h=Ua(n);try{for(h.s();!(t=h.n()).done;){var v=t.value;if(!c[v]){var y=r(v);g+y+2*i>a&&(g=0,d++),c[v]={x:g+i,y:p+d*(o+2*i)+i,width:y,height:o},g+=y+2*i}}}catch(e){h.e(e)}finally{h.f()}var m,b=o+2*i;return{mapping:c,xOffset:g,yOffset:p+d*b,canvasHeight:(m=p+(d+1)*b,Math.pow(2,Math.ceil(Math.log2(m))))}}(qa({getFontWidth:function(e){return p.measureText(e).width},fontHeight:1.2*a,buffer:s,characterSet:t,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),g=d.mapping,h=d.canvasHeight,v=d.xOffset,y=d.yOffset;if(f.height!==h){var m=p.getImageData(0,0,f.width,f.height);f.height=h,p.putImageData(m,0,0)}if(rs(p,o,a,i),c){var b,x=new Da.a(a,s,u,l,o,i),w=p.getImageData(0,0,x.size,x.size),P=Ya(t);try{for(P.s();!(b=P.n()).done;){var _=b.value;ns(x.draw(_),w),p.putImageData(w,g[_].x-s,g[_].y+s)}}catch(e){P.e(e)}finally{P.f()}}else{var O,S=Ya(t);try{for(S.s();!(O=S.n()).done;){var C=O.value;p.fillText(C,g[C].x,g[C].y+.9*a)}}catch(e){S.e(e)}finally{S.f()}}return{xOffset:v,yOffset:y,mapping:g,data:f,width:f.width,height:f.height}}},{key:"_getKey",value:function(){var e=this.props,t=e.fontFamily,n=e.fontWeight,r=e.fontSize,o=e.buffer,i=e.sdf,a=e.radius,s=e.cutoff;return i?"".concat(t," ").concat(n," ").concat(r," ").concat(o," ").concat(a," ").concat(s):"".concat(t," ").concat(n," ").concat(r," ").concat(o)}}]),e}();function is(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function as(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?is(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):is(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ss(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var cs={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:function(e){return e.position}},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},us=function(e){d()(n,e);var t=ss(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),e}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[x.project32,x.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(e){if(f()(y()(n.prototype),"updateState",this).call(this,e),e.changeFlags.extensionsChanged){var t,r=this.context.gl;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,r=n.billboard,o=n.sizeScale,i=n.sizeUnits,a=n.sizeMinPixels,s=n.sizeMaxPixels,c=n.getLineWidth,u=this.props.padding;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:r,stroked:Boolean(c),padding:u,sizeUnits:x.UNIT[i],sizeScale:o,sizeMinPixels:a,sizeMaxPixels:s}).draw()}},{key:"_getModel",value:function(e){return new w.Model(e,as(as({},this.getShaders()),{},{id:this.props.id,geometry:new w.Geometry({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}]),n}(x.Layer);function ls(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fs(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function fs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ds(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ps(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ps(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}b()(us,"defaultProps",cs),b()(us,"layerName","TextBackgroundLayer");var hs={start:1,middle:0,end:-1},vs={top:1,center:0,bottom:-1},ys=[0,0,0,255],ms={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:ys},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Qa.characterSet},fontFamily:Qa.fontFamily,fontWeight:Qa.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:ys},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:function(e){return e.text}},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:ys},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},bs=function(e){d()(n,e);var t=gs(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),b()(u()(e),"state",void 0),b()(u()(e),"getBoundingRect",(function(t,n){var r=e.state.fontAtlasManager.mapping,o=e.state.getText,i=e.props,a=i.wordBreak,s=i.maxWidth,c=i.lineHeight,u=i.getTextAnchor,l=i.getAlignmentBaseline,f=Ka(o(t,n)||"",c,a,s,r),p=j()(f.size,2),d=p[0],g=p[1];return[(hs["function"==typeof u?u(t,n):u]-1)*d/2,(vs["function"==typeof l?l(t,n):l]-1)*g/2,d,g]})),b()(u()(e),"getIconOffsets",(function(t,n){for(var r=e.state.fontAtlasManager.mapping,o=e.state.getText,i=e.props,a=i.wordBreak,s=i.maxWidth,c=i.lineHeight,u=i.getTextAnchor,l=i.getAlignmentBaseline,f=Ka(o(t,n)||"",c,a,s,r),p=f.x,d=f.y,g=f.rowWidth,h=j()(f.size,2),v=h[0],y=h[1],m=hs["function"==typeof u?u(t,n):u],b=vs["function"==typeof l?l(t,n):l],x=p.length,w=new Array(2*x),P=0,_=0;_<x;_++){var O=(1-m)*(v-g[_])/2;w[P++]=(m-1)*v/2+O+p[_],w[P++]=(b-1)*y/2+d[_]}return w})),e}return s()(n,[{key:"initializeState",value:function(){this.state={styleVersion:0,fontAtlasManager:new os}}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=e.changeFlags;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}},{key:"getPickingInfo",value:function(e){var t=e.info;return t.object=t.index>=0?this.props.data[t.index]:null,t}},{key:"_updateFontAtlas",value:function(){var e=this.props,t=e.fontSettings,n=e.fontFamily,r=e.fontWeight,o=this.state,i=o.fontAtlasManager,a=o.characterSet,s=ds(ds({},t),{},{characterSet:a,fontFamily:n,fontWeight:r});if(!i.mapping)return i.setProps(s),!0;for(var c in s)if(s[c]!==i.props[c])return i.setProps(s),!0;return!1}},{key:"_updateText",value:function(){var e,t,n=this.props,r=n.data,o=n.characterSet,i=null===(e=r.attributes)||void 0===e?void 0:e.getText,a=this.props.getText,s=r.startIndices,c="auto"===o&&new Set;if(i&&s){var u=function(e){var t=e.value,n=e.length,r=e.stride,o=e.offset,i=e.startIndices,a=e.characterSet,s=t.BYTES_PER_ELEMENT,c=r?r/s:1,u=o?o/s:0,l=i[n]||Math.ceil((t.length-u)/c),f=a&&new Set,p=new Array(n),d=t;if(c>1||u>0){d=new(0,t.constructor)(l);for(var g=0;g<l;g++)d[g]=t[g*c+u]}for(var h=0;h<n;h++){var v=i[h],y=i[h+1]||l,m=d.subarray(v,y);p[h]=String.fromCodePoint.apply(null,m),f&&m.forEach(f.add,f)}if(f){var b,x=Ua(f);try{for(x.s();!(b=x.n()).done;){var w=b.value;a.add(String.fromCodePoint(w))}}catch(e){x.e(e)}finally{x.f()}}return{texts:p,characterCount:l}}(ds(ds({},ArrayBuffer.isView(i)?{value:i}:i),{},{length:r.length,startIndices:s,characterSet:c})),l=u.texts;t=u.characterCount,a=function(e,t){var n=t.index;return l[n]}}else{var f=Object(x.createIterable)(r),p=f.iterable,d=f.objectInfo;s=[0],t=0;var g,h=ls(p);try{for(h.s();!(g=h.n()).done;){var v=g.value;d.index++;var y=Array.from(a(v,d)||"");c&&y.forEach(c.add,c),t+=y.length,s.push(t)}}catch(e){h.e(e)}finally{h.f()}}this.setState({getText:a,startIndices:s,numInstances:t,characterSet:c||o})}},{key:"renderLayers",value:function(){var e=this.state,t=e.startIndices,n=e.numInstances,r=e.getText,o=e.fontAtlasManager,i=o.scale,a=o.texture,s=o.mapping,c=e.styleVersion,u=this.props,l=u.data,f=u._dataDiff,p=u.getPosition,d=u.getColor,g=u.getSize,h=u.getAngle,v=u.getPixelOffset,y=u.getBackgroundColor,m=u.getBorderColor,b=u.getBorderWidth,x=u.backgroundPadding,w=u.background,P=u.billboard,_=u.fontSettings,O=u.outlineWidth,S=u.outlineColor,C=u.sizeScale,k=u.sizeUnits,L=u.sizeMinPixels,j=u.sizeMaxPixels,A=u.transitions,E=u.updateTriggers,I=this.getSubLayerClass("characters",za),M=this.getSubLayerClass("background",us);return[w&&new M({getFillColor:y,getLineColor:m,getLineWidth:b,padding:x,getPosition:p,getSize:g,getAngle:h,getPixelOffset:v,billboard:P,sizeScale:C/this.state.fontAtlasManager.props.fontSize,sizeUnits:k,sizeMinPixels:L,sizeMaxPixels:j,transitions:A&&{getPosition:A.getPosition,getAngle:A.getAngle,getSize:A.getSize,getFillColor:A.getBackgroundColor,getLineColor:A.getBorderColor,getLineWidth:A.getBorderWidth,getPixelOffset:A.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:E.getPosition,getAngle:E.getAngle,getSize:E.getSize,getFillColor:E.getBackgroundColor,getLineColor:E.getBorderColor,getLineWidth:E.getBorderWidth,getPixelOffset:E.getPixelOffset,getBoundingRect:{getText:E.getText,getTextAnchor:E.getTextAnchor,getAlignmentBaseline:E.getAlignmentBaseline,styleVersion:c}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:f,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new I({sdf:_.sdf,smoothing:Number.isFinite(_.smoothing)?_.smoothing:Qa.smoothing,outlineWidth:O,outlineColor:S,iconAtlas:a,iconMapping:s,getPosition:p,getColor:d,getSize:g,getAngle:h,getPixelOffset:v,billboard:P,sizeScale:C*i,sizeUnits:k,sizeMinPixels:L*i,sizeMaxPixels:j*i,transitions:A&&{getPosition:A.getPosition,getAngle:A.getAngle,getColor:A.getColor,getSize:A.getSize,getPixelOffset:A.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:E.getText,getPosition:E.getPosition,getAngle:E.getAngle,getColor:E.getColor,getSize:E.getSize,getPixelOffset:E.getPixelOffset,getIconOffsets:{getText:E.getText,getTextAnchor:E.getTextAnchor,getAlignmentBaseline:E.getAlignmentBaseline,styleVersion:c}}}),{data:l,_dataDiff:f,startIndices:t,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}}],[{key:"fontAtlasCacheLimit",set:function(e){!function(e){x.log.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),es=new Ja(e)}(e)}}]),n}(x.CompositeLayer);b()(bs,"defaultProps",ms),b()(bs,"layerName","TextLayer");var xs={circle:{type:Zo,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Lo,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:bs,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},ws={type:Gi,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Ps={type:ba,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function _s(e){var t=e.type,n=e.props,r={};for(var o in n)r[o]=t.defaultProps[n[o]];return r}function Os(e,t){var n=e.props,r=n.transitions,o=n.updateTriggers,i={updateTriggers:{},transitions:r&&{getPosition:r.geometry}};for(var a in t){var s=t[a],c=e.props[a];a.startsWith("get")&&(c=e.getSubLayerAccessor(c),i.updateTriggers[s]=o[a],r&&(i.transitions[s]=r[a])),i[s]=c}return i}function Ss(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},o=n.startRow,i=void 0===o?0:o,a=n.endRow,s=void 0===a?e.length:a,c=i;c<s;c++){var u=e[c];x.log.assert(u&&u.geometry,"GeoJSON does not have geometry");var l=u.geometry;if("GeometryCollection"===l.type){x.log.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");for(var f=l.geometries,p=0;p<f.length;p++){var d=f[p];Cs(d,r,t,u,c)}}else Cs(l,r,t,u,c)}return r}function Cs(e,t,n,r,o){var i=e.type,a=e.coordinates,s=t.pointFeatures,c=t.lineFeatures,u=t.polygonFeatures,l=t.polygonOutlineFeatures;if(function(e,t){var n=ks[e];x.log.assert(n,"Unknown GeoJSON type ".concat(e));for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(i,a))switch(i){case"Point":s.push(n({geometry:e},r,o));break;case"MultiPoint":a.forEach((function(e){s.push(n({geometry:{type:"Point",coordinates:e}},r,o))}));break;case"LineString":c.push(n({geometry:e},r,o));break;case"MultiLineString":a.forEach((function(e){c.push(n({geometry:{type:"LineString",coordinates:e}},r,o))}));break;case"Polygon":u.push(n({geometry:e},r,o)),a.forEach((function(e){l.push(n({geometry:{type:"LineString",coordinates:e}},r,o))}));break;case"MultiPolygon":a.forEach((function(e){u.push(n({geometry:{type:"Polygon",coordinates:e}},r,o)),e.forEach((function(e){l.push(n({geometry:{type:"LineString",coordinates:e}},r,o))}))}))}else x.log.warn("".concat(i," coordinates are malformed"))()}var ks={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Ls(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function js(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ls(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ls(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function As(e){return e.geometry.coordinates}function Es(e,t){var n={points:{},lines:{},polygons:{},polygonsOutline:{}},r=e.points,o=e.lines,i=e.polygons,a=function(e,t){var n={points:null,lines:null,polygons:null};for(var r in n){var o=e[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*o.length);for(var i=[],a=0;a<o.length;a++)t(o[a],i),n[r][3*a+0]=i[0],n[r][3*a+1]=i[1],n[r][3*a+2]=i[2]}return n}(e,t);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:js(js({},r.attributes),{},{getPosition:r.positions,instancePickingColors:{size:3,value:a.points}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:o.pathIndices.value.length-1,startIndices:o.pathIndices.value,attributes:js(js({},o.attributes),{},{getPath:o.positions,instancePickingColors:{size:3,value:a.lines}}),properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.lines._pathType="open",n.polygons.data={length:i.polygonIndices.value.length-1,startIndices:i.polygonIndices.value,attributes:js(js({},i.attributes),{},{getPolygon:i.positions,pickingColors:{size:3,value:a.polygons}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.polygons._normalize=!1,i.triangles&&(n.polygons.data.attributes.indices=i.triangles.value),n.polygonsOutline.data={length:i.primitivePolygonIndices.value.length-1,startIndices:i.primitivePolygonIndices.value,attributes:js(js({},i.attributes),{},{getPath:i.positions,instancePickingColors:{size:3,value:a.polygons}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.polygonsOutline._pathType="open",n}var Is=["instancePickingColors"];function Ms(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ts(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ts(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}function zs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zs(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ds=["points","linestrings","polygons"],Us=Fs(Fs(Fs(Fs(Fs(Fs({},_s(xs.circle)),_s(xs.icon)),_s(xs.text)),_s(ws)),_s(Ps)),{},{stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:function(e){return e.properties.icon}},getText:{type:"accessor",value:function(e){return e.properties.text}},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}}),Bs=function(e){d()(n,e);var t=Rs(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"initializeState",value:function(){this.state={layerProps:{},features:{}}}},{key:"updateState",value:function(e){var t=e.props,n=e.changeFlags;if(n.dataChanged){var r=this.props.data,o=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:o}),o?this._updateStateBinary({props:t,changeFlags:n}):this._updateStateJSON({props:t,changeFlags:n})}}},{key:"_updateStateBinary",value:function(e){var t=e.props,n=(e.changeFlags,Es(t.data,this.encodePickingColor));this.setState({layerProps:n})}},{key:"_updateStateJSON",value:function(e){var t=e.props,n=e.changeFlags,r=function(e){if(Array.isArray(e))return e;switch(x.log.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return x.log.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),o=this.getSubLayerRow.bind(this),i={},a={};if(Array.isArray(n.dataChanged)){var s=this.state.features;for(var c in s)i[c]=s[c].slice(),a[c]=[];var u,l=Ms(n.dataChanged);try{for(l.s();!(u=l.n()).done;){var f=u.value,p=Ss(r,o,f);for(var d in s)a[d].push(xa({data:i[d],getIndex:function(e){return e.__source.index},dataRange:f,replace:p[d]}))}}catch(e){l.e(e)}finally{l.f()}}else i=Ss(r,o);var g=function(e,t){var n={points:{},lines:{},polygons:{},polygonsOutline:{}},r=e.pointFeatures,o=e.lineFeatures,i=e.polygonFeatures,a=e.polygonOutlineFeatures;return n.points.data=r,n.points._dataDiff=t.pointFeatures&&function(){return t.pointFeatures},n.points.getPosition=As,n.lines.data=o,n.lines._dataDiff=t.lineFeatures&&function(){return t.lineFeatures},n.lines.getPath=As,n.polygons.data=i,n.polygons._dataDiff=t.polygonFeatures&&function(){return t.polygonFeatures},n.polygons.getPolygon=As,n.polygonsOutline.data=a,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&function(){return t.polygonOutlineFeatures},n.polygonsOutline.getPath=As,n}(i,a);this.setState({features:i,featuresDiff:a,layerProps:g})}},{key:"getPickingInfo",value:function(e){var t=this,r=f()(y()(n.prototype),"getPickingInfo",this).call(this,e),o=r.index,i=r.sourceLayer;return r.featureType=Ds.find((function(e){return i.id.startsWith("".concat(t.id,"-").concat(e,"-"))})),o>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(r.index=this.props.data.points.globalFeatureIds.value[o]),r}},{key:"_updateAutoHighlight",value:function(e){var t,n="".concat(this.id,"-points-"),r="points"===e.featureType,o=Ms(this.getSubLayers());try{for(o.s();!(t=o.n()).done;){var i=t.value;i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}}catch(e){o.e(e)}finally{o.f()}}},{key:"_renderPolygonLayer",value:function(){var e=this.props,t=e.extruded,n=e.wireframe,r=this.state.layerProps,o="polygons-fill",i=this.shouldRenderSubLayer(o,r.polygons.data)&&this.getSubLayerClass(o,Ps.type);if(i){var a=Os(this,Ps.props),s=t&&n;return s||delete a.getLineColor,a.updateTriggers.lineColors=s,new i(a,this.getSubLayerProps({id:o,updateTriggers:a.updateTriggers}),r.polygons)}return null}},{key:"_renderLineLayers",value:function(){var e=this.props,t=e.extruded,n=e.stroked,r=this.state.layerProps,o=!t&&n&&this.shouldRenderSubLayer("polygons-stroke",r.polygonsOutline.data)&&this.getSubLayerClass("polygons-stroke",ws.type),i=this.shouldRenderSubLayer("linestrings",r.lines.data)&&this.getSubLayerClass("linestrings",ws.type);if(o||i){var a=Os(this,ws.props);return[o&&new o(a,this.getSubLayerProps({id:"polygons-stroke",updateTriggers:a.updateTriggers}),r.polygonsOutline),i&&new i(a,this.getSubLayerProps({id:"linestrings",updateTriggers:a.updateTriggers}),r.lines)]}return null}},{key:"_renderPointLayers",value:function(){var e=this.props.pointType,t=this.state,n=t.layerProps,r=t.binary,o=this.props.highlightedObjectIndex;!r&&Number.isFinite(o)&&(o=n.points.data.findIndex((function(e){return e.__source.index===o})));var i,a=[],s=Ms(new Set(e.split("+")));try{for(s.s();!(i=s.n()).done;){var c=i.value,u="points-".concat(c),l=xs[c],f=l&&this.shouldRenderSubLayer(u,n.points.data)&&this.getSubLayerClass(u,l.type);if(f){var p=Os(this,l.props),d=n.points;if("text"===c&&r){var g=d.data.attributes,h=(g.instancePickingColors,La()(g,Is));d=Fs(Fs({},d),{},{data:Fs(Fs({},d.data),{},{attributes:h})})}a.push(new f(p,this.getSubLayerProps({id:u,updateTriggers:p.updateTriggers,highlightedObjectIndex:o}),d))}}}catch(e){s.e(e)}finally{s.f()}return a}},{key:"renderLayers",value:function(){var e=this.props.extruded,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}},{key:"getSubLayerAccessor",value:function(e){return this.state.binary&&"function"==typeof e?function(t,n){var r=Ea(n.data,n.index);return e(r,n)}:f()(y()(n.prototype),"getSubLayerAccessor",this).call(this,e)}}]),n}(x.CompositeLayer);b()(Bs,"layerName","GeoJsonLayer"),b()(Bs,"defaultProps",Us),n.d(t,"ArcLayer",(function(){return k})),n.d(t,"BitmapLayer",(function(){return $})),n.d(t,"IconLayer",(function(){return Lo})),n.d(t,"LineLayer",(function(){return Mo})),n.d(t,"PointCloudLayer",(function(){return Bo})),n.d(t,"ScatterplotLayer",(function(){return Zo})),n.d(t,"ColumnLayer",(function(){return Ci})),n.d(t,"GridCellLayer",(function(){return Li})),n.d(t,"PathLayer",(function(){return Gi})),n.d(t,"PolygonLayer",(function(){return Ca})),n.d(t,"GeoJsonLayer",(function(){return Bs})),n.d(t,"TextLayer",(function(){return bs})),n.d(t,"SolidPolygonLayer",(function(){return ba})),n.d(t,"_MultiIconLayer",(function(){return za})),n.d(t,"_TextBackgroundLayer",(function(){return us}))}])}));