{"version":3,"sources":["../../../src/text-layer/text-layer.ts"],"names":["TEXT_ANCHOR","start","middle","end","ALIGNMENT_BASELINE","top","center","bottom","DEFAULT_COLOR","DEFAULT_LINE_HEIGHT","defaultProps","billboard","sizeScale","sizeUnits","sizeMinPixels","sizeMaxPixels","Number","MAX_SAFE_INTEGER","background","getBackgroundColor","type","value","getBorderColor","getBorderWidth","backgroundPadding","characterSet","DEFAULT_FONT_SETTINGS","fontFamily","fontWeight","lineHeight","outlineWidth","min","outlineColor","fontSettings","wordBreak","maxWidth","getText","x","text","getPosition","position","getColor","getSize","getAngle","getTextAnchor","getAlignmentBaseline","getPixelOffset","backgroundColor","deprecatedFor","TextLayer","object","objectInfo","iconMapping","state","fontAtlasManager","mapping","props","paragraph","size","width","height","anchorX","anchorY","y","rowWidth","numCharacters","length","offsets","Array","index","i","rowOffset","styleVersion","FontAtlasManager","params","oldProps","changeFlags","textChanged","dataChanged","updateTriggersChanged","all","_updateText","fontChanged","_updateFontAtlas","styleChanged","setState","info","data","fontProps","setProps","key","textBuffer","attributes","startIndices","numInstances","autoCharacterSet","Set","ArrayBuffer","isView","texts","characterCount","_","iterable","from","forEach","add","push","scale","texture","_dataDiff","transitions","updateTriggers","CharactersLayerClass","getSubLayerClass","MultiIconLayer","BackgroundLayerClass","TextBackgroundLayer","getFillColor","getLineColor","getLineWidth","padding","fontSize","getSubLayerProps","id","getBoundingRect","autoHighlight","sdf","smoothing","isFinite","iconAtlas","getIcon","getIconOffsets","limit","CompositeLayer"],"mappings":"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","sourcesContent":["// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport {CompositeLayer, createIterable} from '@deck.gl/core';\nimport MultiIconLayer from './multi-icon-layer/multi-icon-layer';\nimport FontAtlasManager, {\n  DEFAULT_FONT_SETTINGS,\n  setFontAtlasCacheLimit\n} from './font-atlas-manager';\nimport {transformParagraph, getTextFromBuffer} from './utils';\n\nimport TextBackgroundLayer from './text-background-layer/text-background-layer';\n\nimport type {FontSettings} from './font-atlas-manager';\nimport type {\n  LayerProps,\n  Accessor,\n  AccessorFunction,\n  Unit,\n  Position,\n  Color,\n  UpdateParameters,\n  GetPickingInfoParams,\n  PickingInfo,\n  DefaultProps\n} from '@deck.gl/core';\n\nconst TEXT_ANCHOR = {\n  start: 1,\n  middle: 0,\n  end: -1\n} as const;\n\nconst ALIGNMENT_BASELINE = {\n  top: 1,\n  center: 0,\n  bottom: -1\n} as const;\n\nconst DEFAULT_COLOR: [number, number, number, number] = [0, 0, 0, 255];\n\nconst DEFAULT_LINE_HEIGHT = 1.0;\n\ntype _TextLayerProps<DataT> = {\n  /** If `true`, the text always faces camera. Otherwise the text faces up (z).\n   * @default true\n   */\n  billboard?: boolean;\n  /**\n   * Text size multiplier.\n   * @default 1\n   */\n  sizeScale?: number;\n  /**\n   * The units of the size, one of `'meters'`, `'common'`, and `'pixels'`.\n   * @default 'pixels'\n   */\n  sizeUnits?: Unit;\n  /**\n   * The minimum size in pixels. When using non-pixel `sizeUnits`, this prop can be used to prevent the icon from getting too small when zoomed out.\n   * @default 0\n   */\n  sizeMinPixels?: number;\n  /**\n   * The maximum size in pixels. When using non-pixel `sizeUnits`, this prop can be used to prevent the icon from getting too big when zoomed in.\n   * @default Number.MAX_SAFE_INTEGER\n   */\n  sizeMaxPixels?: number;\n\n  /** Whether to render background for the text blocks.\n   * @default false\n   */\n  background?: boolean;\n  /** Background color accessor.\n   * @default [255, 255, 255, 255]\n   */\n  getBackgroundColor?: Accessor<DataT, Color>;\n  /** Border color accessor.\n   * @default [0, 0, 0, 255]\n   */\n  getBorderColor?: Accessor<DataT, Color>;\n  /** Border width accessor.\n   * @default 0\n   */\n  getBorderWidth?: Accessor<DataT, number>;\n  /**\n   * The padding of the background..\n   * If an array of 2 is supplied, it is interpreted as `[padding_x, padding_y]` in pixels.\n   * If an array of 4 is supplied, it is interpreted as `[padding_left, padding_top, padding_right, padding_bottom]` in pixels.\n   * @default [0, 0, 0, 0]\n   */\n  backgroundPadding?: [number, number] | [number, number, number, number];\n  /**\n   * Specifies a list of characters to include in the font. If set to 'auto', will be automatically generated from the data set.\n   * @default (ASCII characters 32-128)\n   */\n  characterSet?: FontSettings['characterSet'] | 'auto';\n  /** CSS font family\n   * @default 'Monaco, monospace'\n   */\n  fontFamily?: FontSettings['fontFamily'];\n  /** CSS font weight\n   * @default 'normal'\n   */\n  fontWeight?: FontSettings['fontWeight'];\n  /** A unitless number that will be multiplied with the current font size to set the line height.\n   * @default 'normal'\n   */\n  lineHeight?: number;\n  /**\n   * Width of outline around the text, relative to the font size. Only effective if `fontSettings.sdf` is `true`.\n   * @default 0\n   */\n  outlineWidth?: number;\n  /**\n   * Color of outline around the text, in `[r, g, b, [a]]`. Each channel is a number between 0-255 and `a` is 255 if not supplied.\n   * @default [0, 0, 0, 255]\n   */\n  outlineColor?: Color;\n  /**\n   * Advance options for fine tuning the appearance and performance of the generated shared `fontAtlas`.\n   */\n  fontSettings?: FontSettings;\n  /**\n   * Available options are `break-all` and `break-word`. A valid `maxWidth` has to be provided to use `wordBreak`.\n   * @default 'break-word'\n   */\n  wordBreak?: 'break-word' | 'break-all';\n  /**\n   * `maxWidth` is used together with `break-word` for wrapping text. The value of `maxWidth` specifies the width limit to break the text into multiple lines.\n   * @default -1\n   */\n  maxWidth?: number;\n  /**\n   * Label text accessor\n   */\n  getText?: AccessorFunction<DataT, string>;\n  /**\n   * Anchor position accessor\n   */\n  getPosition?: Accessor<DataT, Position>;\n  /**\n   * Label color accessor\n   * @default [0, 0, 0, 255]\n   */\n  getColor?: Accessor<DataT, Color>;\n  /**\n   * Label size accessor\n   * @default 32\n   */\n  getSize?: Accessor<DataT, number>;\n  /**\n   * Label rotation accessor, in degrees\n   * @default 0\n   */\n  getAngle?: Accessor<DataT, number>;\n  /**\n   * Horizontal alignment accessor\n   * @default 'middle'\n   */\n  getTextAnchor?: Accessor<DataT, 'start' | 'middle' | 'end'>;\n  /**\n   * Vertical alignment accessor\n   * @default 'center'\n   */\n  getAlignmentBaseline?: Accessor<DataT, 'top' | 'center' | 'bottom'>;\n  /**\n   * Label offset from the anchor position, [x, y] in pixels\n   * @default [0, 0]\n   */\n  getPixelOffset?: Accessor<DataT, [number, number]>;\n  /**\n   * @deprecated Use `background` and `getBackgroundColor` instead\n   */\n  backgroundColor?: Color;\n};\n\nexport type TextLayerProps<DataT = any> = _TextLayerProps<DataT> & LayerProps<DataT>;\n\nconst defaultProps: DefaultProps<TextLayerProps> = {\n  billboard: true,\n  sizeScale: 1,\n  sizeUnits: 'pixels',\n  sizeMinPixels: 0,\n  sizeMaxPixels: Number.MAX_SAFE_INTEGER,\n\n  background: false,\n  getBackgroundColor: {type: 'accessor', value: [255, 255, 255, 255]},\n  getBorderColor: {type: 'accessor', value: DEFAULT_COLOR},\n  getBorderWidth: {type: 'accessor', value: 0},\n  backgroundPadding: {type: 'array', value: [0, 0, 0, 0]},\n\n  characterSet: {type: 'object', value: DEFAULT_FONT_SETTINGS.characterSet},\n  fontFamily: DEFAULT_FONT_SETTINGS.fontFamily,\n  fontWeight: DEFAULT_FONT_SETTINGS.fontWeight,\n  lineHeight: DEFAULT_LINE_HEIGHT,\n  outlineWidth: {type: 'number', value: 0, min: 0},\n  outlineColor: {type: 'color', value: DEFAULT_COLOR},\n  fontSettings: {},\n\n  // auto wrapping options\n  wordBreak: 'break-word',\n  maxWidth: {type: 'number', value: -1},\n\n  getText: {type: 'accessor', value: x => x.text},\n  getPosition: {type: 'accessor', value: x => x.position},\n  getColor: {type: 'accessor', value: DEFAULT_COLOR},\n  getSize: {type: 'accessor', value: 32},\n  getAngle: {type: 'accessor', value: 0},\n  getTextAnchor: {type: 'accessor', value: 'middle'},\n  getAlignmentBaseline: {type: 'accessor', value: 'center'},\n  getPixelOffset: {type: 'accessor', value: [0, 0]},\n\n  // deprecated\n  backgroundColor: {deprecatedFor: ['background', 'getBackgroundColor']}\n};\n\n/** Render text labels at given coordinates. */\nexport default class TextLayer<DataT = any, ExtraPropsT = {}> extends CompositeLayer<\n  ExtraPropsT & Required<_TextLayerProps<DataT>>\n> {\n  static defaultProps = defaultProps;\n  static layerName = 'TextLayer';\n\n  state!: {\n    styleVersion: number;\n    fontAtlasManager: FontAtlasManager;\n    characterSet?: Set<string>;\n    startIndices?: number[];\n    numInstances?: number;\n    getText?: AccessorFunction<DataT, string>;\n  };\n\n  initializeState() {\n    this.state = {\n      styleVersion: 0,\n      fontAtlasManager: new FontAtlasManager()\n    };\n  }\n\n  // eslint-disable-next-line complexity\n  updateState(params: UpdateParameters<this>) {\n    const {props, oldProps, changeFlags} = params;\n    const textChanged =\n      changeFlags.dataChanged ||\n      (changeFlags.updateTriggersChanged &&\n        (changeFlags.updateTriggersChanged.all || changeFlags.updateTriggersChanged.getText));\n\n    if (textChanged) {\n      this._updateText();\n    }\n\n    const fontChanged = this._updateFontAtlas();\n\n    const styleChanged =\n      fontChanged ||\n      props.lineHeight !== oldProps.lineHeight ||\n      props.wordBreak !== oldProps.wordBreak ||\n      props.maxWidth !== oldProps.maxWidth;\n\n    if (styleChanged) {\n      this.setState({\n        styleVersion: this.state.styleVersion + 1\n      });\n    }\n  }\n\n  getPickingInfo({info}: GetPickingInfoParams): PickingInfo {\n    // because `TextLayer` assign the same pickingInfoIndex for one text label,\n    // here info.index refers the index of text label in props.data\n    info.object = info.index >= 0 ? this.props.data[info.index] : null;\n    return info;\n  }\n\n  /** Returns true if font has changed */\n  private _updateFontAtlas(): boolean {\n    const {fontSettings, fontFamily, fontWeight} = this.props;\n    const {fontAtlasManager, characterSet} = this.state;\n\n    const fontProps = {\n      ...fontSettings,\n      characterSet,\n      fontFamily,\n      fontWeight\n    };\n\n    if (!fontAtlasManager.mapping) {\n      // This is the first update\n      fontAtlasManager.setProps(fontProps);\n      return true;\n    }\n\n    for (const key in fontProps) {\n      if (fontProps[key] !== fontAtlasManager.props[key]) {\n        fontAtlasManager.setProps(fontProps);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  // Text strings are variable width objects\n  // Count characters and start offsets\n  private _updateText() {\n    const {data, characterSet} = this.props;\n    const textBuffer = (data as any).attributes?.getText;\n    let {getText} = this.props;\n    let startIndices: number[] = (data as any).startIndices;\n    let numInstances: number;\n\n    const autoCharacterSet = characterSet === 'auto' && new Set();\n\n    if (textBuffer && startIndices) {\n      const {texts, characterCount} = getTextFromBuffer({\n        ...(ArrayBuffer.isView(textBuffer) ? {value: textBuffer} : textBuffer),\n        // @ts-ignore if data.attribute is defined then length is expected\n        length: data.length,\n        startIndices,\n        characterSet: autoCharacterSet\n      });\n      numInstances = characterCount;\n      getText = (_, {index}) => texts[index];\n    } else {\n      const {iterable, objectInfo} = createIterable(data);\n      startIndices = [0];\n      numInstances = 0;\n\n      for (const object of iterable) {\n        objectInfo.index++;\n        // Break into an array of characters\n        // When dealing with double-length unicode characters, `str.length` or `str[i]` do not work\n        const text = Array.from(getText(object, objectInfo) || '');\n        if (autoCharacterSet) {\n          // eslint-disable-next-line @typescript-eslint/unbound-method\n          text.forEach(autoCharacterSet.add, autoCharacterSet);\n        }\n        numInstances += text.length;\n        startIndices.push(numInstances);\n      }\n    }\n\n    this.setState({\n      getText,\n      startIndices,\n      numInstances,\n      characterSet: autoCharacterSet || characterSet\n    });\n  }\n\n  // Returns the x, y offsets of each character in a text string\n  private getBoundingRect: AccessorFunction<DataT, [number, number, number, number]> = (\n    object,\n    objectInfo\n  ) => {\n    const iconMapping = this.state.fontAtlasManager.mapping!;\n    const getText = this.state.getText!;\n    const {wordBreak, maxWidth, lineHeight, getTextAnchor, getAlignmentBaseline} = this.props;\n\n    const paragraph = getText(object, objectInfo) || '';\n    const {\n      size: [width, height]\n    } = transformParagraph(paragraph, lineHeight, wordBreak, maxWidth, iconMapping);\n    const anchorX =\n      TEXT_ANCHOR[\n        typeof getTextAnchor === 'function' ? getTextAnchor(object, objectInfo) : getTextAnchor\n      ];\n    const anchorY =\n      ALIGNMENT_BASELINE[\n        typeof getAlignmentBaseline === 'function'\n          ? getAlignmentBaseline(object, objectInfo)\n          : getAlignmentBaseline\n      ];\n\n    return [((anchorX - 1) * width) / 2, ((anchorY - 1) * height) / 2, width, height];\n  };\n\n  // Returns the x, y, w, h of each text object\n  private getIconOffsets: AccessorFunction<DataT, number[]> = (object, objectInfo) => {\n    const iconMapping = this.state.fontAtlasManager.mapping!;\n    const getText = this.state.getText!;\n    const {wordBreak, maxWidth, lineHeight, getTextAnchor, getAlignmentBaseline} = this.props;\n\n    const paragraph = getText(object, objectInfo) || '';\n    const {\n      x,\n      y,\n      rowWidth,\n      size: [width, height]\n    } = transformParagraph(paragraph, lineHeight, wordBreak, maxWidth, iconMapping);\n    const anchorX =\n      TEXT_ANCHOR[\n        typeof getTextAnchor === 'function' ? getTextAnchor(object, objectInfo) : getTextAnchor\n      ];\n    const anchorY =\n      ALIGNMENT_BASELINE[\n        typeof getAlignmentBaseline === 'function'\n          ? getAlignmentBaseline(object, objectInfo)\n          : getAlignmentBaseline\n      ];\n\n    const numCharacters = x.length;\n    const offsets = new Array(numCharacters * 2);\n    let index = 0;\n\n    for (let i = 0; i < numCharacters; i++) {\n      // For a multi-line object, offset in x-direction needs consider\n      // the row offset in the paragraph and the object offset in the row\n      const rowOffset = ((1 - anchorX) * (width - rowWidth[i])) / 2;\n      offsets[index++] = ((anchorX - 1) * width) / 2 + rowOffset + x[i];\n      offsets[index++] = ((anchorY - 1) * height) / 2 + y[i];\n    }\n    return offsets;\n  };\n\n  renderLayers() {\n    const {\n      startIndices,\n      numInstances,\n      getText,\n      fontAtlasManager: {scale, texture, mapping},\n      styleVersion\n    } = this.state;\n\n    const {\n      data,\n      _dataDiff,\n      getPosition,\n      getColor,\n      getSize,\n      getAngle,\n      getPixelOffset,\n      getBackgroundColor,\n      getBorderColor,\n      getBorderWidth,\n      backgroundPadding,\n      background,\n      billboard,\n      fontSettings,\n      outlineWidth,\n      outlineColor,\n      sizeScale,\n      sizeUnits,\n      sizeMinPixels,\n      sizeMaxPixels,\n      transitions,\n      updateTriggers\n    } = this.props;\n\n    const CharactersLayerClass = this.getSubLayerClass('characters', MultiIconLayer);\n    const BackgroundLayerClass = this.getSubLayerClass('background', TextBackgroundLayer);\n\n    return [\n      background &&\n        new BackgroundLayerClass(\n          {\n            // background props\n            getFillColor: getBackgroundColor,\n            getLineColor: getBorderColor,\n            getLineWidth: getBorderWidth,\n            padding: backgroundPadding,\n\n            // props shared with characters layer\n            getPosition,\n            getSize,\n            getAngle,\n            getPixelOffset,\n            billboard,\n            sizeScale: sizeScale / this.state.fontAtlasManager.props.fontSize,\n            sizeUnits,\n            sizeMinPixels,\n            sizeMaxPixels,\n\n            transitions: transitions && {\n              getPosition: transitions.getPosition,\n              getAngle: transitions.getAngle,\n              getSize: transitions.getSize,\n              getFillColor: transitions.getBackgroundColor,\n              getLineColor: transitions.getBorderColor,\n              getLineWidth: transitions.getBorderWidth,\n              getPixelOffset: transitions.getPixelOffset\n            }\n          },\n          this.getSubLayerProps({\n            id: 'background',\n            updateTriggers: {\n              getPosition: updateTriggers.getPosition,\n              getAngle: updateTriggers.getAngle,\n              getSize: updateTriggers.getSize,\n              getFillColor: updateTriggers.getBackgroundColor,\n              getLineColor: updateTriggers.getBorderColor,\n              getLineWidth: updateTriggers.getBorderWidth,\n              getPixelOffset: updateTriggers.getPixelOffset,\n              getBoundingRect: {\n                getText: updateTriggers.getText,\n                getTextAnchor: updateTriggers.getTextAnchor,\n                getAlignmentBaseline: updateTriggers.getAlignmentBaseline,\n                styleVersion\n              }\n            }\n          }),\n          {\n            data:\n              // @ts-ignore (2339) attribute is not defined on all data types\n              data.attributes && data.attributes.background\n                ? // @ts-ignore (2339) attribute is not defined on all data types\n                  {length: data.length, attributes: data.attributes.background}\n                : data,\n            _dataDiff,\n            // Maintain the same background behavior as <=8.3. Remove in v9?\n            autoHighlight: false,\n            getBoundingRect: this.getBoundingRect\n          }\n        ),\n      new CharactersLayerClass(\n        {\n          sdf: fontSettings.sdf,\n          smoothing: Number.isFinite(fontSettings.smoothing)\n            ? fontSettings.smoothing\n            : DEFAULT_FONT_SETTINGS.smoothing,\n          outlineWidth,\n          outlineColor,\n          iconAtlas: texture,\n          iconMapping: mapping,\n\n          getPosition,\n          getColor,\n          getSize,\n          getAngle,\n          getPixelOffset,\n\n          billboard,\n          sizeScale: sizeScale * scale,\n          sizeUnits,\n          sizeMinPixels: sizeMinPixels * scale,\n          sizeMaxPixels: sizeMaxPixels * scale,\n\n          transitions: transitions && {\n            getPosition: transitions.getPosition,\n            getAngle: transitions.getAngle,\n            getColor: transitions.getColor,\n            getSize: transitions.getSize,\n            getPixelOffset: transitions.getPixelOffset\n          }\n        },\n        this.getSubLayerProps({\n          id: 'characters',\n          updateTriggers: {\n            getIcon: updateTriggers.getText,\n            getPosition: updateTriggers.getPosition,\n            getAngle: updateTriggers.getAngle,\n            getColor: updateTriggers.getColor,\n            getSize: updateTriggers.getSize,\n            getPixelOffset: updateTriggers.getPixelOffset,\n            getIconOffsets: {\n              getText: updateTriggers.getText,\n              getTextAnchor: updateTriggers.getTextAnchor,\n              getAlignmentBaseline: updateTriggers.getAlignmentBaseline,\n              styleVersion\n            }\n          }\n        }),\n        {\n          data,\n          _dataDiff,\n          startIndices,\n          numInstances,\n          getIconOffsets: this.getIconOffsets,\n          getIcon: getText\n        }\n      )\n    ];\n  }\n\n  static set fontAtlasCacheLimit(limit: number) {\n    setFontAtlasCacheLimit(limit);\n  }\n}\n"],"file":"text-layer.js"}