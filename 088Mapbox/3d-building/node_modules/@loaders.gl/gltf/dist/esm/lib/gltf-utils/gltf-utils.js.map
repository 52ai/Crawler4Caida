{"version":3,"sources":["../../../../src/lib/gltf-utils/gltf-utils.ts"],"names":["assert","TYPES","ARRAY_CONSTRUCTOR_TO_WEBGL_CONSTANT","Int8Array","Uint8Array","Int16Array","Uint16Array","Uint32Array","Float32Array","Float64Array","ARRAY_TO_COMPONENT_TYPE","Map","ATTRIBUTE_TYPE_TO_COMPONENTS","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE","ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY","getAccessorTypeFromSize","size","type","getComponentTypeFromArray","typedArray","componentType","get","constructor","Error","getAccessorArrayTypeAndLength","accessor","bufferView","ArrayType","components","bytesPerComponent","length","count","byteLength"],"mappings":"AAAA,SAAQA,MAAR,QAAqB,iBAArB;AAEA,MAAMC,KAAK,GAAG,CAAC,QAAD,EAAW,MAAX,EAAmB,MAAnB,EAA2B,MAA3B,CAAd;AAcA,MAAMC,mCAAsE,GAAG,CAC7E,CAACC,SAAD,EAAY,IAAZ,CAD6E,EAE7E,CAACC,UAAD,EAAa,IAAb,CAF6E,EAG7E,CAACC,UAAD,EAAa,IAAb,CAH6E,EAI7E,CAACC,WAAD,EAAc,IAAd,CAJ6E,EAK7E,CAACC,WAAD,EAAc,IAAd,CAL6E,EAM7E,CAACC,YAAD,EAAe,IAAf,CAN6E,EAO7E,CAACC,YAAD,EAAe,IAAf,CAP6E,CAA/E;AASA,MAAMC,uBAAuB,GAAG,IAAIC,GAAJ,CAC9BT,mCAD8B,CAAhC;AAIA,MAAMU,4BAA4B,GAAG;AACnCC,EAAAA,MAAM,EAAE,CAD2B;AAEnCC,EAAAA,IAAI,EAAE,CAF6B;AAGnCC,EAAAA,IAAI,EAAE,CAH6B;AAInCC,EAAAA,IAAI,EAAE,CAJ6B;AAKnCC,EAAAA,IAAI,EAAE,CAL6B;AAMnCC,EAAAA,IAAI,EAAE,CAN6B;AAOnCC,EAAAA,IAAI,EAAE;AAP6B,CAArC;AAUA,MAAMC,qCAAqC,GAAG;AAC5C,QAAM,CADsC;AAE5C,QAAM,CAFsC;AAG5C,QAAM,CAHsC;AAI5C,QAAM,CAJsC;AAK5C,QAAM,CALsC;AAM5C,QAAM;AANsC,CAA9C;AASA,MAAMC,iCAAiC,GAAG;AACxC,QAAMlB,SADkC;AAExC,QAAMC,UAFkC;AAGxC,QAAMC,UAHkC;AAIxC,QAAMC,WAJkC;AAKxC,QAAMC,WALkC;AAMxC,QAAMC;AANkC,CAA1C;AASA,OAAO,SAASc,uBAAT,CAAiCC,IAAjC,EAAuC;AAC5C,QAAMC,IAAI,GAAGvB,KAAK,CAACsB,IAAI,GAAG,CAAR,CAAlB;AACA,SAAOC,IAAI,IAAIvB,KAAK,CAAC,CAAD,CAApB;AACD;AAED,OAAO,SAASwB,yBAAT,CAAmCC,UAAnC,EAA+C;AACpD,QAAMC,aAAa,GAAGjB,uBAAuB,CAACkB,GAAxB,CAA4BF,UAAU,CAACG,WAAvC,CAAtB;;AACA,MAAI,CAACF,aAAL,EAAoB;AAClB,UAAM,IAAIG,KAAJ,CAAU,qBAAV,CAAN;AACD;;AACD,SAAOH,aAAP;AACD;AAED,OAAO,SAASI,6BAAT,CAAuCC,QAAvC,EAAiDC,UAAjD,EAA6D;AAClE,QAAMC,SAAS,GAAGb,iCAAiC,CAACW,QAAQ,CAACL,aAAV,CAAnD;AACA,QAAMQ,UAAU,GAAGvB,4BAA4B,CAACoB,QAAQ,CAACR,IAAV,CAA/C;AACA,QAAMY,iBAAiB,GAAGhB,qCAAqC,CAACY,QAAQ,CAACL,aAAV,CAA/D;AACA,QAAMU,MAAM,GAAGL,QAAQ,CAACM,KAAT,GAAiBH,UAAhC;AACA,QAAMI,UAAU,GAAGP,QAAQ,CAACM,KAAT,GAAiBH,UAAjB,GAA8BC,iBAAjD;AACApC,EAAAA,MAAM,CAACuC,UAAU,IAAI,CAAd,IAAmBA,UAAU,IAAIN,UAAU,CAACM,UAA7C,CAAN;AACA,SAAO;AAACL,IAAAA,SAAD;AAAYG,IAAAA,MAAZ;AAAoBE,IAAAA;AAApB,GAAP;AACD","sourcesContent":["import {assert} from '../utils/assert';\n\nconst TYPES = ['SCALAR', 'VEC2', 'VEC3', 'VEC4'];\n\ntype TypedArrayConstructor =\n  | Int8ArrayConstructor\n  | Uint8ArrayConstructor\n  | Int16ArrayConstructor\n  | Uint16ArrayConstructor\n  | Int32ArrayConstructor\n  | Uint32ArrayConstructor\n  | Int32ArrayConstructor\n  | Uint32ArrayConstructor\n  | Float32ArrayConstructor\n  | Float64ArrayConstructor;\n\nconst ARRAY_CONSTRUCTOR_TO_WEBGL_CONSTANT: [TypedArrayConstructor, number][] = [\n  [Int8Array, 5120],\n  [Uint8Array, 5121],\n  [Int16Array, 5122],\n  [Uint16Array, 5123],\n  [Uint32Array, 5125],\n  [Float32Array, 5126],\n  [Float64Array, 5130]\n];\nconst ARRAY_TO_COMPONENT_TYPE = new Map<TypedArrayConstructor, number>(\n  ARRAY_CONSTRUCTOR_TO_WEBGL_CONSTANT\n);\n\nconst ATTRIBUTE_TYPE_TO_COMPONENTS = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\n\nconst ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE = {\n  5120: 1,\n  5121: 1,\n  5122: 2,\n  5123: 2,\n  5125: 4,\n  5126: 4\n};\n\nconst ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array\n};\n\nexport function getAccessorTypeFromSize(size) {\n  const type = TYPES[size - 1];\n  return type || TYPES[0];\n}\n\nexport function getComponentTypeFromArray(typedArray) {\n  const componentType = ARRAY_TO_COMPONENT_TYPE.get(typedArray.constructor);\n  if (!componentType) {\n    throw new Error('Illegal typed array');\n  }\n  return componentType;\n}\n\nexport function getAccessorArrayTypeAndLength(accessor, bufferView) {\n  const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[accessor.componentType];\n  const components = ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type];\n  const bytesPerComponent = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[accessor.componentType];\n  const length = accessor.count * components;\n  const byteLength = accessor.count * components * bytesPerComponent;\n  assert(byteLength >= 0 && byteLength <= bufferView.byteLength);\n  return {ArrayType, length, byteLength};\n}\n"],"file":"gltf-utils.js"}